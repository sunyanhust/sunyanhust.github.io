<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://sunyanhust.github.io</id>
    <title>Gridea</title>
    <updated>2020-06-16T17:39:35.176Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://sunyanhust.github.io"/>
    <link rel="self" href="https://sunyanhust.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://sunyanhust.github.io/images/avatar.png</logo>
    <icon>https://sunyanhust.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[LeetCodeï¼šæœ‰æ•ˆçš„æ‹¬å·]]></title>
        <id>https://sunyanhust.github.io/post/leetcodeyou-xiao-de-gua-hao/</id>
        <link href="https://sunyanhust.github.io/post/leetcodeyou-xiao-de-gua-hao/">
        </link>
        <updated>2020-06-16T17:33:00.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®">é¢˜ç›®</h2>
<p>ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ '('ï¼Œ')'ï¼Œ'{'ï¼Œ'}'ï¼Œ'['ï¼Œ']'Â çš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚<br>
æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š</p>
<ol>
<li>å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚</li>
<li>å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚</li>
</ol>
<p>æ³¨æ„ï¼šç©ºå­—ç¬¦ä¸²å¯è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²ã€‚</p>
<p>ç¤ºä¾‹ 1:</p>
<pre><code class="language-bash">è¾“å…¥: &quot;()&quot;
è¾“å‡º: true
</code></pre>
<p>ç¤ºä¾‹Â 2:</p>
<pre><code class="language-bash">è¾“å…¥: &quot;()[]{}&quot;
è¾“å‡º: true
</code></pre>
<p>ç¤ºä¾‹Â 3:</p>
<pre><code class="language-bash">è¾“å…¥: &quot;(]&quot;
è¾“å‡º: false
</code></pre>
<p>ç¤ºä¾‹Â 4:</p>
<pre><code class="language-bash">è¾“å…¥: &quot;([)]&quot;
è¾“å‡º: false
</code></pre>
<p>ç¤ºä¾‹Â 5:</p>
<pre><code class="language-bash">è¾“å…¥: &quot;{[]}&quot;
è¾“å‡º: true
</code></pre>
<p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/valid-parentheses</p>
<h2 id="é¢˜è§£">é¢˜è§£</h2>
<p>è¿ç”¨æ ˆçš„æ¦‚å¿µï¼Œå…ˆå…¥åå‡ºã€‚åè¿›çš„å·¦æ‹¬å·æœ€å…ˆåˆ é™¤ï¼Œæœ€ååˆ¤æ–­æ ˆçš„é•¿åº¦å’ŒæŸäº›ç‰¹æ®Šæƒ…å†µï¼ˆå¦‚åªæœ‰ä¸€ä¸ªå³æ‹¬å·çš„æƒ…å†µï¼‰ã€‚</p>
<pre><code class="language-python">class Solution:
    def isValid(self, s: str) -&gt; bool:
        
        if s==&quot;&quot;:
            return True
        
        temp = []
        for st in s:

            if st == &quot;(&quot; or st=='{' or st=='[':
                temp.append(st)
            else:
                
                if not temp: return False

                if st==')' and temp[-1]=='(':
                    temp.pop(-1)
                elif st=='}' and temp[-1]=='{':
                    temp.pop(-1)
                elif st==']' and temp[-1]=='[':
                    temp.pop(-1)
                else:
                    return False
        
        if len(temp)==0:
            return True
        else:
            return False
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeï¼šæ•´æ•°åè½¬]]></title>
        <id>https://sunyanhust.github.io/post/leetcodezheng-shu-fan-zhuan/</id>
        <link href="https://sunyanhust.github.io/post/leetcodezheng-shu-fan-zhuan/">
        </link>
        <updated>2020-06-16T16:24:43.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®">é¢˜ç›®</h2>
<p>ç»™å‡ºä¸€ä¸ª 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•´æ•°ä¸­æ¯ä½ä¸Šçš„æ•°å­—è¿›è¡Œåè½¬ã€‚</p>
<p>ç¤ºä¾‹Â 1:</p>
<pre><code class="language-bash">è¾“å…¥: 123
è¾“å‡º: 321
</code></pre>
<p>ç¤ºä¾‹ 2:</p>
<pre><code class="language-bash">è¾“å…¥: -123
è¾“å‡º: -321
</code></pre>
<p>ç¤ºä¾‹ 3:</p>
<pre><code class="language-bash">è¾“å…¥: 120
è¾“å‡º: 21
</code></pre>
<p>æ³¨æ„: å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨å¾—ä¸‹ 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œåˆ™å…¶æ•°å€¼èŒƒå›´ä¸ºÂ [âˆ’2^31,Â  2^31Â âˆ’ 1]ã€‚è¯·æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œå¦‚æœåè½¬åæ•´æ•°æº¢å‡ºé‚£ä¹ˆå°±è¿”å› 0ã€‚</p>
<p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/reverse-integer</p>
<h2 id="é¢˜è§£">é¢˜è§£</h2>
<p>åŸºæœ¬åšæ³•æœ‰ä¸¤ç§ã€‚ä¸€ç§æ˜¯è½¬å­—ç¬¦ä¸²åšï¼Œä¸€ç§æ˜¯ç”¨æ•´æ•°é™¤æ³•ï¼ˆç©ºé—´ä¸Šæ›´ä¼˜ï¼‰ã€‚é¢˜ç›®çœ‹çš„æ—¶å€™å¿˜äº†æ³¨æ„éƒ¨åˆ†ï¼Œåœ¨æäº¤æŸ¥çœ‹é”™ä¾‹çš„æ—¶å€™æ‰çŒœæµ‹åˆ°ï¼Œæ³¨æ„ä»¥åæŠŠé¢˜ç›®çœ‹å®Œã€‚</p>
<h2 id="è½¬ä¸ºå­—ç¬¦ä¸²">è½¬ä¸ºå­—ç¬¦ä¸²</h2>
<pre><code class="language-python">class Solution:
    def reverse(self, x: int) -&gt; int:
        if x&gt;0:
            result = int(&quot;&quot;.join(list(str(x))[::-1]))
        else:
            result = -int(&quot;&quot;.join(list(str(-x))[::-1]))
        
        if -2**31&lt; result &lt;2**31-1:
            return result
        else:
            return 0
</code></pre>
<h2 id="æ•´æ•°é™¤æ³•">æ•´æ•°é™¤æ³•</h2>
<p>æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ„å»ºåè½¬æ•´æ•°çš„ä¸€ä½æ•°å­—ã€‚åœ¨è¿™æ ·åšçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆæ£€æŸ¥å‘åŸæ•´æ•°é™„åŠ å¦ä¸€ä½æ•°å­—æ˜¯å¦ä¼šå¯¼è‡´æº¢å‡ºã€‚<br>
<img src="https://sunyanhust.github.io/post-images/1592325610163.png" alt="" loading="lazy"><br>
ä¼˜åŒ–è§£ï¼š<br>
æ—¶é—´å¤æ‚åº¦ï¼šO(log(x))ï¼Œxä¸­å¤§çº¦æœ‰log10(x) ä½æ•°å­—ã€‚<br>
ç©ºé—´å¤æ‚åº¦ï¼šO(1)</p>
<pre><code class="language-python">class Solution:
    def reverse(self, x: int) -&gt; int:
        y, res = abs(x), 0
        boundry = 2**31-1 if x&gt;0 else 2**31
        while y != 0:
            res = res*10 +y%10
            if res &gt; boundry :
                return 0
            y //=10
        return res if x &gt;0 else -res
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç»å…¸æ·±åº¦å­¦ä¹ è®ºæ–‡å›é¡¾ï¼šLeNet]]></title>
        <id>https://sunyanhust.github.io/post/jing-dian-shen-du-xue-xi-lun-wen-hui-gu-lenet/</id>
        <link href="https://sunyanhust.github.io/post/jing-dian-shen-du-xue-xi-lun-wen-hui-gu-lenet/">
        </link>
        <updated>2020-06-15T06:39:29.000Z</updated>
        <content type="html"><![CDATA[<h2 id="è®ºæ–‡">è®ºæ–‡</h2>
<p>è®ºæ–‡ï¼šLeCun, Y., Bottou, L., Bengio, Y., &amp; Haffner, P. (1998). Gradient-based learning applied to document recognition. Proceedings of the IEEE, 86(11), 2278-2324.</p>
<h2 id="èƒŒæ™¯ä»‹ç»">èƒŒæ™¯ä»‹ç»</h2>
<p>Yan LeCunç­‰äººäº1998å¹´ç¬¬ä¸€æ¬¡å°†å·ç§¯ç¥ç»ç½‘ç»œï¼ˆLeNetï¼‰åº”ç”¨åˆ°å›¾åƒåˆ†ç±»ä»»åŠ¡ä¸Šï¼Œåœ¨æ‰‹å†™æ•°å­—è¯†åˆ«ä»»åŠ¡ä¸Šå–å¾—äº†å·¨å¤§æˆåŠŸã€‚LeNetçš„ç½‘ç»œç»“æ„ï¼Œéº»é›€è™½å°ï¼Œä½†äº”è„ä¿±å…¨ï¼Œå·ç§¯å±‚ã€poolingå±‚ã€å…¨è¿æ¥å±‚ï¼Œè¿™äº›éƒ½æ˜¯ç°ä»£CNNç½‘ç»œçš„åŸºæœ¬ç»„ä»¶ã€‚</p>
<h2 id="æ¨¡å‹ç»“æ„">æ¨¡å‹ç»“æ„</h2>
<figure data-type="image" tabindex="1"><img src="https://sunyanhust.github.io/post-images/1592204054863.jpg" alt="" loading="lazy"></figure>
<h2 id="ä»£ç å®ç°">ä»£ç å®ç°</h2>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeï¼šæœ€é•¿å…¬å…±å‰ç¼€]]></title>
        <id>https://sunyanhust.github.io/post/leetcodezui-chang-gong-gong-qian-zhui/</id>
        <link href="https://sunyanhust.github.io/post/leetcodezui-chang-gong-gong-qian-zhui/">
        </link>
        <updated>2020-06-15T05:52:01.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®">é¢˜ç›®</h2>
<p>ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚å¦‚æœä¸å­˜åœ¨å…¬å…±å‰ç¼€ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²Â &quot;&quot;ã€‚</p>
<p>ç¤ºä¾‹Â 1:</p>
<pre><code class="language-bash">è¾“å…¥: [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]
è¾“å‡º: &quot;fl&quot;
</code></pre>
<p>ç¤ºä¾‹Â 2:</p>
<pre><code class="language-bash">è¾“å…¥: [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]
è¾“å‡º: &quot;&quot;
è§£é‡Š: è¾“å…¥ä¸å­˜åœ¨å…¬å…±å‰ç¼€ã€‚
</code></pre>
<p>è¯´æ˜: æ‰€æœ‰è¾“å…¥åªåŒ…å«å°å†™å­—æ¯Â a-zÂ ã€‚</p>
<p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/longest-common-prefix</p>
<h2 id="è§£æ³•">è§£æ³•</h2>
<p>æ–¹æ³•1å’Œæ–¹æ³•2æ¯”è¾ƒå¸¸è§„ï¼Œæˆ‘è‡ªå·±è§£é¢˜çš„æ—¶å€™ç”¨çš„æ–¹æ³•2ã€‚æ–¹æ³•3åˆ©ç”¨å­—ç¬¦ä¸²æ’åºï¼Œéå¸¸å·§å¦™ã€‚æ–¹æ³•4æ˜¯å­—å…¸æ ‘ï¼Œç›´è§‰ä¸Šå¯ä»¥ï¼Œä½†æ˜¯æˆ‘å¯¹å­—å…¸æ ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚</p>
<h3 id="æ¨ªå‘æ‰«æ">æ¨ªå‘æ‰«æ</h3>
<p>ä¾æ¬¡éå†å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºæ¯ä¸ªéå†åˆ°çš„å­—ç¬¦ä¸²ï¼Œæ›´æ–°æœ€é•¿å…¬å…±å‰ç¼€ï¼Œå½“éå†å®Œæ‰€æœ‰çš„å­—ç¬¦ä¸²ä»¥åï¼Œå³å¯å¾—åˆ°å­—ç¬¦ä¸²æ•°ç»„ä¸­çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚<br>
<img src="https://sunyanhust.github.io/post-images/1592200588023.png" alt="" loading="lazy"></p>
<h3 id="çºµå‘æ‰«æ">çºµå‘æ‰«æ</h3>
<p>çºµå‘æ‰«ææ—¶ï¼Œä»å‰å¾€åéå†æ‰€æœ‰å­—ç¬¦ä¸²çš„æ¯ä¸€åˆ—ï¼Œæ¯”è¾ƒç›¸åŒåˆ—ä¸Šçš„å­—ç¬¦æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™ç»§ç»­å¯¹ä¸‹ä¸€åˆ—è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸åŒåˆ™å½“å‰åˆ—ä¸å†å±äºå…¬å…±å‰ç¼€ï¼Œå½“å‰åˆ—ä¹‹å‰çš„éƒ¨åˆ†ä¸ºæœ€é•¿å…¬å…±å‰ç¼€ã€‚<br>
<img src="https://sunyanhust.github.io/post-images/1592200615614.png" alt="" loading="lazy"><br>
è¿™ç§æ–¹æ³•å’Œæˆ‘æƒ³çš„ä¸€è‡´ï¼Œè´´ä¸€ä¸‹æˆ‘çš„ä»£ç ï¼š</p>
<pre><code class="language-python">class Solution:
    def longestCommonPrefix(self, strs: List[str]) -&gt; str:
        cp = &quot;&quot;
        if not strs:
            return cp
        min_str_len = min([len(s) for s in strs])
        strs_num = len(strs)
        for i in range(min_str_len):
            temp = strs[0][i]
            same = True
            for j in range(strs_num):
                if strs[j][i] != temp:
                    same =False
                    break
            if same:
                cp += temp
            else:
                return cp
        return cp
</code></pre>
<p>åœ¨é¢˜è§£ä¸­è¿˜çœ‹åˆ°ä¸€ç§ä½¿ç”¨zipå‡½æ•°çš„ä¾¿æ·å†™æ³•ï¼š</p>
<pre><code class="language-python">class Solution(object):
    def longestCommonPrefix(self, strs):
        ans = ''
        for i in zip(*strs):
            if len(set(i)) == 1:
                ans += i[0]
            else:
                break
        return ans
</code></pre>
<p>åˆ©ç”¨pythonçš„zipå‡½æ•°ï¼ŒæŠŠstrçœ‹æˆlistç„¶åæŠŠè¾“å…¥çœ‹æˆäºŒç»´æ•°ç»„ï¼Œå·¦å¯¹é½çºµå‘å‹ç¼©ï¼Œç„¶åæŠŠæ¯é¡¹åˆ©ç”¨é›†åˆå»é‡ï¼Œä¹‹åéå†listä¸­æ‰¾åˆ°å…ƒç´ é•¿åº¦å¤§äº1ä¹‹å‰çš„å°±æ˜¯å…¬å…±å‰ç¼€ã€‚</p>
<h3 id="å­—ç¬¦ä¸²æ’åº">å­—ç¬¦ä¸²æ’åº</h3>
<p>åˆ©ç”¨pythonçš„max()å’Œmin()ï¼Œåœ¨pythoné‡Œå­—ç¬¦ä¸²æ˜¯å¯ä»¥æ¯”è¾ƒçš„ï¼ŒæŒ‰ç…§ascIIå€¼æ’ï¼Œä¸¾ä¾‹abbï¼Œ abaï¼Œabacï¼Œæœ€å¤§ä¸ºabbï¼Œæœ€å°ä¸ºabaã€‚æ‰€ä»¥åªéœ€è¦æ¯”è¾ƒæœ€å¤§æœ€å°çš„å…¬å…±å‰ç¼€å°±æ˜¯æ•´ä¸ªæ•°ç»„çš„å…¬å…±å‰ç¼€ã€‚</p>
<pre><code class="language-python">def longestCommonPrefix(self, strs):
        if not strs: return &quot;&quot;
        s1 = min(strs)
        s2 = max(strs)
        for i,x in enumerate(s1):
            if x != s2[i]:
                return s2[:i]
        return s1
</code></pre>
<h3 id="å­—å…¸æ ‘">å­—å…¸æ ‘</h3>
<p>æš‚æ—¶ä¸æ˜ç™½ï¼Œåç»­ç†è§£ä¸€ä¸‹ã€‚</p>
<pre><code class="language-python">from collections import defaultdict
from functools import reduce
class Solution:
    def longestCommonPrefix(self, strs: List[str]) -&gt; str:
        if not strs:return &quot;&quot;
        trieNode = lambda:defaultdict(trieNode)
        class Trie:
            def __init__(self):
                self.trie = trieNode()

            def insert(self,word):
                reduce(dict.__getitem__,word,self.trie)['END'] = True

            def search(self,word):
                reduce(lambda d,k:d[k] if k in d else trieNode(),word,self.trie).get('END',False)

            def startsWith(self,word):
                return len(reduce(lambda d,k:d[k] if k in d else trieNode(),word,self.trie)) &gt; 0

            def longestCommonPrefix(self):
                commonPrefixes = &quot;&quot;
                starts = self.trie
                while ('END' not in starts) and len(starts) == 1:
                    append = list(starts.keys())[0]
                    starts = starts.get(append)
                    commonPrefixes += append
                return commonPrefixes

        trie = Trie()
        for word in strs:
            trie.insert(word)
        return trie.longestCommonPrefix()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¦‚ä½•å…¥é—¨æ·±åº¦å­¦ä¹ ]]></title>
        <id>https://sunyanhust.github.io/post/ru-he-ru-men-shen-du-xue-xi/</id>
        <link href="https://sunyanhust.github.io/post/ru-he-ru-men-shen-du-xue-xi/">
        </link>
        <updated>2020-05-22T10:20:45.000Z</updated>
        <content type="html"><![CDATA[<h2 id="step0æ­å»ºæ·±åº¦å­¦ä¹ ç¯å¢ƒ">Step0ï¼šæ­å»ºæ·±åº¦å­¦ä¹ ç¯å¢ƒ</h2>
<ul>
<li>Dokeræ­å»ºæ·±åº¦å­¦ä¹ ç¯å¢ƒï¼šhttps://www.cnblogs.com/bingmang/p/9813686.html</li>
<li>Pycharmè¿œç¨‹è¿æ¥æœåŠ¡å™¨ï¼šhttps://www.cnblogs.com/zhuminghui/p/10947930.html</li>
<li>æœåŠ¡å™¨ä½¿ç”¨screenåå°è¿è¡Œç¨‹åºï¼šhttps://sunyanhust.github.io/post/fu-wu-qi-shi-yong-screen-hou-tai-yun-xing-cheng-xu/</li>
</ul>
<h2 id="step1-é€šè¿‡é˜…è¯»pythonæ·±åº¦å­¦ä¹ æŒæ¡æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†">Step1: é€šè¿‡é˜…è¯»ã€ŠPythonæ·±åº¦å­¦ä¹ ã€‹æŒæ¡æ·±åº¦å­¦ä¹ åŸºç¡€çŸ¥è¯†</h2>
<p>ã€ŠPythonæ·±åº¦å­¦ä¹ ã€‹è¿™æœ¬ä¹¦æ˜¯Kerasä¹‹çˆ¶Francois Cholletæ‰€è‘—ï¼Œè¯¥ä¹¦å‡å®šè¯»è€…æ— ä»»ä½•æœºå™¨å­¦ä¹ çŸ¥è¯†ï¼Œä»¥Kerasä¸ºå·¥å…·ï¼Œä½¿ç”¨ä¸°å¯Œçš„èŒƒä¾‹ç¤ºèŒƒæ·±åº¦å­¦ä¹ çš„æœ€ä½³å®è·µï¼Œè¯¥ä¹¦é€šä¿—æ˜“æ‡‚ï¼Œå…¨ä¹¦æ²¡æœ‰ä¸€ä¸ªæ•°å­¦å…¬å¼ï¼Œæ³¨é‡åŸ¹å…»è¯»è€…çš„æ·±åº¦å­¦ä¹ ç›´è§‰ã€‚</p>
<ul>
<li><strong>ç”µå­ç‰ˆä¸‹è½½</strong>ï¼šhttps://pan.baidu.com/s/1-4q6VjLTb3ZxcefyNCbjSA æå–ç ï¼šwtzoï¼Œ</li>
<li><strong>ä»£ç </strong>ï¼šhttps://github.com/fchollet/deep-learning-with-python-notebooks</li>
</ul>
<h2 id="step2é€šè¿‡æ•™ç¨‹30å¤©åƒæ‰é‚£åª-tensorflow2æ·±å…¥å­¦ä¹ tensorflow">Step2ï¼šé€šè¿‡æ•™ç¨‹ã€Š30å¤©åƒæ‰é‚£åª TensorFlow2ã€‹æ·±å…¥å­¦ä¹ TensorFlow</h2>
<ul>
<li>ğŸ“š gitbookç”µå­ä¹¦åœ°å€ï¼š https://lyhue1991.github.io/eat_tensorflow2_in_30_days</li>
<li>ğŸš€ githubé¡¹ç›®åœ°å€ï¼šhttps://github.com/lyhue1991/eat_tensorflow2_in_30_days</li>
<li>ğŸ³ kesciä¸“æ åœ°å€ï¼šhttps://www.kesci.com/home/column/5d8ef3c3037db3002d3aa3a0</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right">æ—¥æœŸ</th>
<th style="text-align:left">å­¦ä¹ å†…å®¹</th>
<th style="text-align:right">å†…å®¹éš¾åº¦</th>
<th style="text-align:right">é¢„è®¡å­¦ä¹ æ—¶é—´</th>
<th style="text-align:right">æ›´æ–°çŠ¶æ€</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E4%B8%80%E3%80%81TensorFlow%E7%9A%84%E5%BB%BA%E6%A8%A1%E6%B5%81%E7%A8%8B.md"><strong>ä¸€ã€TensorFlowçš„å»ºæ¨¡æµç¨‹</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day1</td>
<td style="text-align:left"><a href="./1-1,%E7%BB%93%E6%9E%84%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1%E6%B5%81%E7%A8%8B%E8%8C%83%E4%BE%8B.md">1-1,ç»“æ„åŒ–æ•°æ®å»ºæ¨¡æµç¨‹èŒƒä¾‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day2</td>
<td style="text-align:left"><a href="./1-2,%E5%9B%BE%E7%89%87%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1%E6%B5%81%E7%A8%8B%E8%8C%83%E4%BE%8B.md">1-2,å›¾ç‰‡æ•°æ®å»ºæ¨¡æµç¨‹èŒƒä¾‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day3</td>
<td style="text-align:left"><a href="./1-3,%E6%96%87%E6%9C%AC%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1%E6%B5%81%E7%A8%8B%E8%8C%83%E4%BE%8B.md">1-3,æ–‡æœ¬æ•°æ®å»ºæ¨¡æµç¨‹èŒƒä¾‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day4</td>
<td style="text-align:left"><a href="./1-4,%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1%E6%B5%81%E7%A8%8B%E8%8C%83%E4%BE%8B.md">1-4,æ—¶é—´åºåˆ—æ•°æ®å»ºæ¨¡æµç¨‹èŒƒä¾‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E4%BA%8C%E3%80%81TensorFlow%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5.md"><strong>äºŒã€TensorFlowçš„æ ¸å¿ƒæ¦‚å¿µ</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day5</td>
<td style="text-align:left"><a href="./2-1,%E5%BC%A0%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.md">2-1,å¼ é‡æ•°æ®ç»“æ„</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day6</td>
<td style="text-align:left"><a href="./2-2,%E4%B8%89%E7%A7%8D%E8%AE%A1%E7%AE%97%E5%9B%BE.md">2-2,ä¸‰ç§è®¡ç®—å›¾</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day7</td>
<td style="text-align:left"><a href="./2-3,%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86%E6%9C%BA%E5%88%B6.md">2-3,è‡ªåŠ¨å¾®åˆ†æœºåˆ¶</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E4%B8%89%E3%80%81TensorFlow%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84.md"><strong>ä¸‰ã€TensorFlowçš„å±‚æ¬¡ç»“æ„</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day8</td>
<td style="text-align:left"><a href="./3-1,%E4%BD%8E%E9%98%B6API%E7%A4%BA%E8%8C%83.md">3-1,ä½é˜¶APIç¤ºèŒƒ</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day9</td>
<td style="text-align:left"><a href="./3-2,%E4%B8%AD%E9%98%B6API%E7%A4%BA%E8%8C%83.md">3-2,ä¸­é˜¶APIç¤ºèŒƒ</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day10</td>
<td style="text-align:left"><a href="./3-3,%E9%AB%98%E9%98%B6API%E7%A4%BA%E8%8C%83.md">3-3,é«˜é˜¶APIç¤ºèŒƒ</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E5%9B%9B%E3%80%81TensorFlow%E7%9A%84%E4%BD%8E%E9%98%B6API.md"><strong>å››ã€TensorFlowçš„ä½é˜¶API</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day11</td>
<td style="text-align:left"><a href="./4-1,%E5%BC%A0%E9%87%8F%E7%9A%84%E7%BB%93%E6%9E%84%E6%93%8D%E4%BD%9C.md">4-1,å¼ é‡çš„ç»“æ„æ“ä½œ</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day12</td>
<td style="text-align:left"><a href="./4-2,%E5%BC%A0%E9%87%8F%E7%9A%84%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97.md">4-2,å¼ é‡çš„æ•°å­¦è¿ç®—</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day13</td>
<td style="text-align:left"><a href="./4-3,AutoGraph%E7%9A%84%E4%BD%BF%E7%94%A8%E8%A7%84%E8%8C%83.md">4-3,AutoGraphçš„ä½¿ç”¨è§„èŒƒ</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day14</td>
<td style="text-align:left"><a href="./4-4,AutoGraph%E7%9A%84%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86.md">4-4,AutoGraphçš„æœºåˆ¶åŸç†</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day15</td>
<td style="text-align:left"><a href="./4-5,AutoGraph%E5%92%8Ctf.Module.md">4-5,AutoGraphå’Œtf.Module</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E4%BA%94%E3%80%81TensorFlow%E7%9A%84%E4%B8%AD%E9%98%B6API.md"><strong>äº”ã€TensorFlowçš„ä¸­é˜¶API</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day16</td>
<td style="text-align:left"><a href="./5-1,%E6%95%B0%E6%8D%AE%E7%AE%A1%E9%81%93Dataset.md">5-1,æ•°æ®ç®¡é“Dataset</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day17</td>
<td style="text-align:left"><a href="./5-2,%E7%89%B9%E5%BE%81%E5%88%97feature_column.md">5-2,ç‰¹å¾åˆ—feature_column</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day18</td>
<td style="text-align:left"><a href="./5-3,%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0activation.md">5-3,æ¿€æ´»å‡½æ•°activation</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day19</td>
<td style="text-align:left"><a href="./5-4,%E6%A8%A1%E5%9E%8B%E5%B1%82layers.md">5-4,æ¨¡å‹å±‚layers</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day20</td>
<td style="text-align:left"><a href="./5-5,%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0losses.md">5-5,æŸå¤±å‡½æ•°losses</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day21</td>
<td style="text-align:left"><a href="./5-6,%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87metrics.md">5-6,è¯„ä¼°æŒ‡æ ‡metrics</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day22</td>
<td style="text-align:left"><a href="./5-7,%E4%BC%98%E5%8C%96%E5%99%A8optimizers.md">5-7,ä¼˜åŒ–å™¨optimizers</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day23</td>
<td style="text-align:left"><a href="./5-8,%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0callbacks.md">5-8,å›è°ƒå‡½æ•°callbacks</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E5%85%AD%E3%80%81TensorFlow%E7%9A%84%E9%AB%98%E9%98%B6API.md"><strong>å…­ã€TensorFlowçš„é«˜é˜¶API</strong></a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day24</td>
<td style="text-align:left"><a href="./6-1,%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B%E7%9A%843%E7%A7%8D%E6%96%B9%E6%B3%95.md">6-1,æ„å»ºæ¨¡å‹çš„3ç§æ–¹æ³•</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day25</td>
<td style="text-align:left"><a href="./6-2,%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E7%9A%843%E7%A7%8D%E6%96%B9%E6%B3%95.md">6-2,è®­ç»ƒæ¨¡å‹çš„3ç§æ–¹æ³•</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day26</td>
<td style="text-align:left"><a href="./6-3,%E4%BD%BF%E7%94%A8%E5%8D%95GPU%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B.md">6-3,ä½¿ç”¨å•GPUè®­ç»ƒæ¨¡å‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day27</td>
<td style="text-align:left"><a href="./6-4,%E4%BD%BF%E7%94%A8%E5%A4%9AGPU%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B.md">6-4,ä½¿ç”¨å¤šGPUè®­ç»ƒæ¨¡å‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day28</td>
<td style="text-align:left"><a href="./6-5,%E4%BD%BF%E7%94%A8TPU%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B.md">6-5,ä½¿ç”¨TPUè®­ç»ƒæ¨¡å‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸</td>
<td style="text-align:right">0.5hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day29</td>
<td style="text-align:left"><a href="./6-6,%E4%BD%BF%E7%94%A8tensorflow-serving%E9%83%A8%E7%BD%B2%E6%A8%A1%E5%9E%8B.md">6-6,ä½¿ç”¨tensorflow-servingéƒ¨ç½²æ¨¡å‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">1hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">day30</td>
<td style="text-align:left"><a href="./6-7,%E4%BD%BF%E7%94%A8spark-scala%E8%B0%83%E7%94%A8tensorflow%E6%A8%A1%E5%9E%8B.md">6-7,ä½¿ç”¨spark-scalaè°ƒç”¨tensorflowæ¨¡å‹</a></td>
<td style="text-align:right">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</td>
<td style="text-align:right">2hour</td>
<td style="text-align:right">âœ…</td>
</tr>
<tr>
<td style="text-align:right">Â </td>
<td style="text-align:left"><a href="./%E5%90%8E%E8%AE%B0%EF%BC%9A%E4%B8%80%E4%B8%AA%E5%90%83%E8%B4%A7%E5%92%8C%E4%B8%80%E9%81%93%E8%8F%9C%E7%9A%84%E6%95%85%E4%BA%8B.md">åè®°ï¼šä¸€ä¸ªåƒè´§å’Œä¸€é“èœçš„æ•…äº‹</a></td>
<td style="text-align:right">â­ï¸</td>
<td style="text-align:right">0hour</td>
<td style="text-align:right">âœ…</td>
</tr>
</tbody>
</table>
<h2 id="step4-é€šè¿‡cnn-architecturesé¡¹ç›®å¤ç°å¸¸è§cnnæ¨¡å‹å¹¶é˜…è¯»æœ‰å…³è®ºæ–‡">Step4: é€šè¿‡ã€ŠCNN-Architecturesã€‹é¡¹ç›®å¤ç°å¸¸è§CNNæ¨¡å‹ï¼Œå¹¶é˜…è¯»æœ‰å…³è®ºæ–‡</h2>
<p><strong>CNN-Architecturesï¼š</strong>  https://github.com/Machine-Learning-Tokyo/CNN-Architectures/tree/master/Implementations</p>
<p>ä½¿ç”¨<code>tf.keras</code>APIå¤ç°äº†ä¸€äº›å¸¸è§CNNæ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼šAlexNetã€VGGã€GoogLeNetã€MobileNetã€ResNetã€Xceptionã€SqueezeNetã€DenseNetã€ShuffleNet</p>
<h2 id="step5-é€šè¿‡deep-models-for-nlp-beginnersé¡¹ç›®å­¦ä¹ nlpåŸºç¡€çŸ¥è¯†">Step5: é€šè¿‡ã€ŠDeep Models for NLP beginnersã€‹é¡¹ç›®å­¦ä¹ NLPåŸºç¡€çŸ¥è¯†</h2>
<p>Deep Models for NLP beginnersï¼šhttps://github.com/BrambleXu/nlp-beginner-guide-keras</p>
<p>åŒ…æ‹¬è¯å‘é‡ã€æƒ…æ„Ÿåˆ†ç±»ä»¥åŠå®ä½“è¯†åˆ«</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[çŸ¥è¯†ç‚¹å¤‡å¿˜]]></title>
        <id>https://sunyanhust.github.io/post/zhi-shi-dian-bei-wang-he-todo/</id>
        <link href="https://sunyanhust.github.io/post/zhi-shi-dian-bei-wang-he-todo/">
        </link>
        <updated>2020-04-16T03:02:25.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ¯”è¾ƒçç¢çš„çŸ¥è¯†">æ¯”è¾ƒçç¢çš„çŸ¥è¯†</h2>
<ul>
<li>è”æƒ³å°æ–°æ˜¯å¼€æœºæŒ‰F2è¿›å…¥bios</li>
<li>windowsä¸Šç¼–è¾‘çš„shæ–‡ä»¶åœ¨linuxä¸Šéœ€è¦è½¬æ¢ï¼Œè½¬æ¢è½¯ä»¶ä¸º<code>doc2unix</code>ï¼Œå‘½ä»¤ä¸º<code>doc2unix filename</code></li>
<li>GPUæœºå™¨ä¹‹é—´æ‹·è´æ–‡ä»¶ç›´æ¥scpåŠ ä¸Šæœºå™¨çš„ipåœ°å€å°±å¯ä»¥ï¼Œå› ä¸ºå„ä¸ªæœºå™¨åœ¨åŒä¸€å±€åŸŸç½‘å†…</li>
</ul>
<h2 id="æ–‡æœ¬åˆ†ç±»kaggle-kernel">æ–‡æœ¬åˆ†ç±»kaggle kernel</h2>
<h3 id="åŸºäºlstmçš„å¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»">åŸºäºLSTMçš„å¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»</h3>
<p>kaggle kernel é“¾æ¥ï¼š https://www.kaggle.com/rftexas/gru-lstm-rnn-101</p>
<p><strong>ä¸»è¦äº®ç‚¹</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨äº†tf.kerasè¿›è¡Œæ„å»ºï¼Œå¾ˆå¤šä»£ç å¯ä»¥å¤ç”¨ä¸ºbaseline</li>
<li>è¯»å–å’ŒåŠ è½½Gloveè¯å‘é‡</li>
<li>AUCä½œä¸ºè¯„ä»·æ ‡å‡†</li>
<li>æ•°æ®é›†å¤„ç†ä¸ºtf_datasetè¾“å…¥kerasæ¨¡å‹</li>
<li>åœ¨è®­ç»ƒé›†è®­ç»ƒåï¼Œåœ¨éªŒè¯é›†ç»§ç»­è®­ç»ƒä¸¤ä¸ªepochsï¼ˆå°æŠ€å·§ï¼Œå¯èƒ½å¾ˆæœ‰ç”¨ï¼‰</li>
</ol>
<pre><code class="language-python">import gc
import pickle
import re
import string
import warnings

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import tensorflow as tf
from keras.preprocessing.sequence import pad_sequences
from keras.preprocessing.text import Tokenizer
from tensorflow.keras import backend as K
from tensorflow.keras.losses import binary_crossentropy
from tensorflow.keras import initializers, regularizers, constraints
from tensorflow.keras.callbacks import ReduceLROnPlateau, LearningRateScheduler, EarlyStopping
from tensorflow.keras.layers import Layer, Dense, Input, Embedding, SpatialDropout1D, Bidirectional, LSTM, \
    GlobalMaxPooling1D, GlobalAveragePooling1D
from tensorflow.keras.layers import concatenate
from tensorflow.keras.models import Model
from tqdm.notebook import tqdm

tqdm.pandas()

warnings.simplefilter('ignore')

# HYPERPARAMETERS
MAX_LEN = 220
MAX_FEATURES = 100000
EMBED_SIZE = 600
BATCH_SIZE = 128
N_EPOCHS = 5
LEARNING_RATE = 8e-4

# We will concatenate Crawl and GloVe embeddings
CRAWL_EMB_PATH = '../input/pickled-glove840b300d-for-10sec-loading/glove.840B.300d.pkl'
GLOVE_EMB_PATH = '../input/pickled-crawl300d2m-for-kernel-competitions/crawl-300d-2M.pkl'


def display_training_curves(training, validation, title, subplot):
    &quot;&quot;&quot;
    Quickly display training curves
    &quot;&quot;&quot;
    if subplot % 10 == 1:
        plt.subplots(figsize=(10, 10), facecolor='#F0F0F0')
        plt.tight_layout()

    ax = plt.subplot(subplot)
    ax.set_facecolor('#F8F8F8')
    ax.plot(training)
    ax.plot(validation)
    ax.set_title('model' + title)
    ax.set_ylabel(title)
    ax.set_xlabel('epoch')
    ax.legend(['train', 'valid'])


def get_coeffs(word, *arr):
    return word, np.asarray(arr, dtype='float32')


def load_embeddings(embed_dir):
    with open(embed_dir, 'rb') as  infile:
        embeddings = pickle.load(infile)
        return embeddings


def build_embedding_matrix(word_index, embeddings_index, max_features, lower=True, verbose=True):
    embedding_matrix = np.zeros((max_features, 300))
    for word, i in tqdm(word_index.items(), len=(word_index.items())):
        if lower:
            word = word.lower()
        if i &gt;= max_features: continue
        try:
            embedding_vector = embeddings_index[word]
        except:
            embedding_vector = embeddings_index[&quot;unknown&quot;]
        if embedding_vector is not None:
            # words not found in embedding index will be all-zeros.
            embedding_matrix[i] = embedding_vector
    return embedding_matrix


def build_matrix(word_index, embeddings_index):
    embedding_matrix = np.zeros((len(word_index) + 1, 300))
    for word, i in word_index.items():
        try:
            embedding_matrix[i] = embeddings_index[word]
        except:
            embedding_matrix[i] = embeddings_index[&quot;unknown&quot;]
    return embedding_matrix


class Attention(Layer):
    &quot;&quot;&quot;
    Custom Keras attention layer
    Reference: https://www.kaggle.com/qqgeogor/keras-lstm-attention-glove840b-lb-0-043
    &quot;&quot;&quot;

    def __init__(self, step_dim, W_regularizer=None, b_regularizer=None,
                 W_constraint=None, b_constraint=None, bias=True, **kwargs):

        self.supports_masking = True

        self.bias = bias
        self.step_dim = step_dim
        self.features_dim = None
        super(Attention, self).__init__(**kwargs)

        self.param_W = {
            'initializer': initializers.get('glorot_uniform'),
            'name': '{}_W'.format(self.name),
            'regularizer': regularizers.get(W_regularizer),
            'constraint': constraints.get(W_constraint)
        }
        self.W = None

        self.param_b = {
            'initializer': 'zero',
            'name': '{}_b'.format(self.name),
            'regularizer': regularizers.get(b_regularizer),
            'constraint': constraints.get(b_constraint)
        }
        self.b = None

    def build(self, input_shape):
        assert len(input_shape) == 3

        self.features_dim = input_shape[-1]
        self.W = self.add_weight(shape=(input_shape[-1],),
                                 **self.param_W)

        if self.bias:
            self.b = self.add_weight(shape=(input_shape[1],),
                                     **self.param_b)

        self.built = True

    def compute_mask(self, input, input_mask=None):
        return None

    def call(self, x, mask=None):
        step_dim = self.step_dim
        features_dim = self.features_dim

        eij = K.reshape(
            K.dot(K.reshape(x, (-1, features_dim)), K.reshape(self.W, (features_dim, 1))),
            (-1, step_dim))

        if self.bias:
            eij += self.b
        eij = K.tanh(eij)
        a = K.exp(eij)

        if mask is not None:
            a *= K.cast(mask, K.floatx())

        a /= K.cast(K.sum(a, axis=1, keepdims=True) + K.epsilon(), K.floatx())
        a = K.expand_dims(a)
        weighted_input = x * a
        return K.sum(weighted_input, axis=1)

    def compute_output_shape(self, input_shape):
        return input_shape[0], self.features_dim


# We create a balanced

print('Loading train sets...')
train1 = pd.read_csv(&quot;/kaggle/input/jigsaw-multilingual-toxic-comment-classification/jigsaw-toxic-comment-train.csv&quot;)
train2 = pd.read_csv(&quot;/kaggle/input/jigsaw-multilingual-toxic-comment-classification/jigsaw-unintended-bias-train.csv&quot;)

train = pd.concat([
    train1[['comment_text', 'toxic']],
    train2[['comment_text', 'toxic']].query('toxic==1'),
    train2[['comment_text', 'toxic']].query('toxic==0').sample(n=100000, random_state=0)
])

del train1, train2

print('Loading validation sets...')
valid = pd.read_csv('/kaggle/input/val-en-df/validation_en.csv')

print('Loading test sets...')
test = pd.read_csv('/kaggle/input/test-en-df/test_en.csv')
sub = pd.read_csv('/kaggle/input/jigsaw-multilingual-toxic-comment-classification/sample_submission.csv')

misspell_dict = {&quot;aren't&quot;: &quot;are not&quot;, &quot;can't&quot;: &quot;cannot&quot;, &quot;couldn't&quot;: &quot;could not&quot;,
                 &quot;didn't&quot;: &quot;did not&quot;, &quot;doesn't&quot;: &quot;does not&quot;, &quot;don't&quot;: &quot;do not&quot;,
                 &quot;hadn't&quot;: &quot;had not&quot;, &quot;hasn't&quot;: &quot;has not&quot;, &quot;haven't&quot;: &quot;have not&quot;,
                 &quot;he'd&quot;: &quot;he would&quot;, &quot;he'll&quot;: &quot;he will&quot;, &quot;he's&quot;: &quot;he is&quot;,
                 &quot;i'd&quot;: &quot;I had&quot;, &quot;i'll&quot;: &quot;I will&quot;, &quot;i'm&quot;: &quot;I am&quot;, &quot;isn't&quot;: &quot;is not&quot;,
                 &quot;it's&quot;: &quot;it is&quot;, &quot;it'll&quot;: &quot;it will&quot;, &quot;i've&quot;: &quot;I have&quot;, &quot;let's&quot;: &quot;let us&quot;,
                 &quot;mightn't&quot;: &quot;might not&quot;, &quot;mustn't&quot;: &quot;must not&quot;, &quot;shan't&quot;: &quot;shall not&quot;,
                 &quot;she'd&quot;: &quot;she would&quot;, &quot;she'll&quot;: &quot;she will&quot;, &quot;she's&quot;: &quot;she is&quot;,
                 &quot;shouldn't&quot;: &quot;should not&quot;, &quot;that's&quot;: &quot;that is&quot;, &quot;there's&quot;: &quot;there is&quot;,
                 &quot;they'd&quot;: &quot;they would&quot;, &quot;they'll&quot;: &quot;they will&quot;, &quot;they're&quot;: &quot;they are&quot;,
                 &quot;they've&quot;: &quot;they have&quot;, &quot;we'd&quot;: &quot;we would&quot;, &quot;we're&quot;: &quot;we are&quot;,
                 &quot;weren't&quot;: &quot;were not&quot;, &quot;we've&quot;: &quot;we have&quot;, &quot;what'll&quot;: &quot;what will&quot;,
                 &quot;what're&quot;: &quot;what are&quot;, &quot;what's&quot;: &quot;what is&quot;, &quot;what've&quot;: &quot;what have&quot;,
                 &quot;where's&quot;: &quot;where is&quot;, &quot;who'd&quot;: &quot;who would&quot;, &quot;who'll&quot;: &quot;who will&quot;,
                 &quot;who're&quot;: &quot;who are&quot;, &quot;who's&quot;: &quot;who is&quot;, &quot;who've&quot;: &quot;who have&quot;,
                 &quot;won't&quot;: &quot;will not&quot;, &quot;wouldn't&quot;: &quot;would not&quot;, &quot;you'd&quot;: &quot;you would&quot;,
                 &quot;you'll&quot;: &quot;you will&quot;, &quot;you're&quot;: &quot;you are&quot;, &quot;you've&quot;: &quot;you have&quot;,
                 &quot;'re&quot;: &quot; are&quot;, &quot;wasn't&quot;: &quot;was not&quot;, &quot;we'll&quot;: &quot; will&quot;, &quot;tryin'&quot;: &quot;trying&quot;}


def _get_misspell(misspell_dict):
    misspell_re = re.compile('(%s)' % '|'.join(misspell_dict.keys()))
    return misspell_dict, misspell_re


def replace_typical_misspell(text):
    misspellings, misspellings_re = _get_misspell(misspell_dict)

    def replace(match):
        return misspellings[match.group(0)]

    return misspellings_re.sub(replace, text)


puncts = [',', '.', '&quot;', ':', ')', '(', '-', '!', '?', '|', ';', &quot;'&quot;, '$', '&amp;', '/', '[', ']',
          '&gt;', '%', '=', '#', '*', '+', '\\', 'â€¢', '~', '@', 'Â£', 'Â·', '_', '{', '}', 'Â©', '^',
          'Â®', '`', '&lt;', 'â†’', 'Â°', 'â‚¬', 'â„¢', 'â€º', 'â™¥', 'â†', 'Ã—', 'Â§', 'â€³', 'â€²', 'Ã‚', 'â–ˆ',
          'Â½', 'Ã ', 'â€¦', 'â€œ', 'â˜…', 'â€', 'â€“', 'â—', 'Ã¢', 'â–º', 'âˆ’', 'Â¢', 'Â²', 'Â¬', 'â–‘', 'Â¶',
          'â†‘', 'Â±', 'Â¿', 'â–¾', 'â•', 'Â¦', 'â•‘', 'â€•', 'Â¥', 'â–“', 'â€”', 'â€¹', 'â”€', 'â–’', 'ï¼š', 'Â¼',
          'âŠ•', 'â–¼', 'â–ª', 'â€ ', 'â– ', 'â€™', 'â–€', 'Â¨', 'â–„', 'â™«', 'â˜†', 'Ã©', 'Â¯', 'â™¦', 'Â¤', 'â–²',
          'Ã¨', 'Â¸', 'Â¾', 'Ãƒ', 'â‹…', 'â€˜', 'âˆ', 'âˆ™', 'ï¼‰', 'â†“', 'ã€', 'â”‚', 'ï¼ˆ', 'Â»', 'ï¼Œ', 'â™ª',
          'â•©', 'â•š', 'Â³', 'ãƒ»', 'â•¦', 'â•£', 'â•”', 'â•—', 'â–¬', 'â¤', 'Ã¯', 'Ã˜', 'Â¹', 'â‰¤', 'â€¡', 'âˆš']


def clean_text(x):
    x = str(x)
    for punct in puncts + list(string.punctuation):
        if punct in x:
            x = x.replace(punct, f' {punct} ')
    return x


def clean_numbers(x):
    return re.sub(r'\d+', ' ', x)


def preprocess(train, valid, test, tfms):
    for tfm in tfms:
        print(tfm.__name__)
        train['comment_text'] = train['comment_text'].progress_apply(tfm)
        valid['comment_text_en'] = valid['comment_text_en'].progress_apply(tfm)
        test['content'] = test['content'].progress_apply(tfm)

    return train, valid, test


tfms = [replace_typical_misspell, clean_text, clean_numbers]
train, valid, test = preprocess(train, valid, test, tfms)

tokenizer = Tokenizer(num_words=MAX_FEATURES, filters='', lower=False)

print('Fitting tokenizer...')
tokenizer.fit_on_texts(list(train['comment_text']) + list(valid['comment_text_en']) + list(test['content_en']))
word_index = tokenizer.word_index

print('Building training set...')
X_train = tokenizer.texts_to_sequences(list(train['comment_text']))
y_train = train['toxic'].values

print('Building validation set...')
X_valid = tokenizer.texts_to_sequences(list(valid['comment_text_en']))
y_valid = valid['toxic'].values

print('Building test set ...')
X_test = tokenizer.texts_to_sequences(list(test['content_en']))

print('Padding sequences...')
X_train = pad_sequences(X_train, maxlen=MAX_LEN)
X_valid = pad_sequences(X_valid, maxlen=MAX_LEN)
X_test = pad_sequences(X_test, maxlen=MAX_LEN)

y_train = train.toxic.values
y_valid = valid.toxic.values

del tokenizer

print('Loading Crawl embeddings...')
crawl_embeddings = load_embeddings(CRAWL_EMB_PATH)

print('Loading GloVe embeddings...')
glove_embeddings = load_embeddings(GLOVE_EMB_PATH)

print('Building matrices...')
embedding_matrix_1 = build_matrix(word_index, crawl_embeddings)
embedding_matrix_2 = build_matrix(word_index, glove_embeddings)

print('Concatenating embedding matrices...')
embedding_matrix = np.concatenate([embedding_matrix_1, embedding_matrix_2], axis=1)

del embedding_matrix_1, embedding_matrix_2
del crawl_embeddings, glove_embeddings

gc.collect()

train_dataset = (
    tf.data.Dataset
        .from_tensor_slices((X_train, y_train))
        .repeat()
        .shuffle(2048)
        .batch(BATCH_SIZE)
)

valid_dataset = (
    tf.data.Dataset
        .from_tensor_slices((X_valid, y_valid))
        .batch(BATCH_SIZE)
        .cache()
)

test_dataset = (
    tf.data.Dataset
        .from_tensor_slices(X_test)
        .batch(BATCH_SIZE)
)


def build_model(word_index, embedding_matrix, verbose=True):
    &quot;&quot;&quot;
    credits go to: https://www.kaggle.com/thousandvoices/simple-lstm/
    &quot;&quot;&quot;
    sequence_input = Input(shape=(MAX_LEN,), dtype=tf.int32)

    embedding_layer = Embedding(*embedding_matrix.shape,
                                weights=[embedding_matrix],
                                trainable=False)

    x = embedding_layer(sequence_input)
    x = SpatialDropout1D(0.3)(x)
    x = Bidirectional(LSTM(256, return_sequences=True))(x)
    x = Bidirectional(LSTM(128, return_sequences=True))(x)

    att = Attention(MAX_LEN)(x)
    avg_pool1 = GlobalAveragePooling1D()(x)
    max_pool1 = GlobalMaxPooling1D()(x)
    hidden = concatenate([att, avg_pool1, max_pool1])

    hidden = Dense(512, activation='relu')(hidden)
    hidden = Dense(128, activation='relu')(hidden)
    out = Dense(1, activation='sigmoid')(hidden)
    model = Model(sequence_input, out)

    return model

model = build_model(word_index, embedding_matrix)
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=[tf.keras.metrics.AUC()])
model.summary()

file_weights = 'best_model.h5'
# cb1 = ModelCheckpoint(file_weights, save_best_only=True)

cb2 = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=3)
cb3 = ReduceLROnPlateau(monitor='val_loss', factor=0.5, patience=2, verbose=1, cooldown=0, min_lr=0.0001)
cb4 = LearningRateScheduler(lambda epoch: LEARNING_RATE * (0.6 ** epoch))

n_steps = X_train.shape[0] // BATCH_SIZE

train_history = model.fit(
    train_dataset,
    steps_per_epoch=n_steps,
    validation_data=valid_dataset,
    callbacks=[cb4],
    epochs=N_EPOCHS
)

display_training_curves(
    train_history.history['loss'],
    train_history.history['val_loss'],
    'loss',
    211)

display_training_curves(
    train_history.history['auc'],
    train_history.history['val_auc'],
    'AUC',
    212)

n_steps = X_valid.shape[0] // BATCH_SIZE

train_history = model.fit(
    valid_dataset.repeat(),
    steps_per_epoch=n_steps,
    callbacks=[cb4],
    epochs=N_EPOCHS
)

preds = model.predict(test_dataset, verbose=1)
sub['toxic'] = preds

</code></pre>
<h3 id="åŸºäºbertçš„å¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»ä½¿ç”¨tpu">åŸºäºBERTçš„å¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»(ä½¿ç”¨TPU)</h3>
<p>kaggle kernel é“¾æ¥ï¼š https://www.kaggle.com/sunyancn/jigsaw-tpu-bert-with-huggingface-and-keras</p>
<p><strong>ä¸»è¦äº®ç‚¹</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨äº†transformersçš„åˆ†è¯å™¨è¿›è¡Œå¿«é€Ÿåˆ†è¯</li>
<li>æ–‡æœ¬é•¿åº¦çš„å¯è§†åŒ–</li>
<li>TF Hub BERTæ¨¡å‹çš„åŠ è½½</li>
<li>TPUç­–ç•¥</li>
</ol>
<pre><code class="language-python"># %% [markdown]
# ## About this notebook
# 
# *[Jigsaw Multilingual Toxic Comment Classification](https://www.kaggle.com/c/jigsaw-multilingual-toxic-comment-classification)* is the 3rd annual competition organized by the Jigsaw team. It follows *[Toxic Comment Classification Challenge](https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge)*, the original 2018 competition, and *[Jigsaw Unintended Bias in Toxicity Classification](https://www.kaggle.com/c/jigsaw-unintended-bias-in-toxicity-classification)*, which required the competitors to consider biased ML predictions in their new models. This year, the goal is to use english only training data to run toxicity predictions on many different languages, which can be done using multilingual models, and speed up using TPUs.
# 
# Many awesome notebooks has already been made so far. Many of them used really cool technologies like [Pytorch XLA](https://www.kaggle.com/theoviel/bert-pytorch-huggingface-starter). This notebook instead aims at constructing a **fast, concise, reusable, and beginner-friendly model scaffold**. It will focus on the following points:
# * **Using Tensorflow and Keras**: Tensorflow is a powerful framework, and Keras makes the training process extremely easy to understand. This is especially good for beginners to learn how to use TPUs, and for experts to focus on the modelling aspect.
# * **Using Huggingface's `transformers` library**: [This library](https://huggingface.co/transformers/) is extremely popular, so using this let you easily integrate the end result into your ML pipelines, and can be easily reused for your other projects.
# * **Native TPU usage**: The TPU usage is abstracted using the native `strategy` that was created using Tensorflow's `tf.distribute.experimental.TPUStrategy`. This avoids getting too much into the lower-level aspect of TPU management.
# * **Use a subset of the data**: Instead of using the entire dataset, we will only use the 2018 subset of the data available, which makes this much faster, all while achieving a respectable accuracy.

# %% [code]
import os
import warnings

import numpy as np
import pandas as pd
import tensorflow as tf
from tensorflow.keras.layers import Dense, Input
from tensorflow.keras.optimizers import Adam
from tensorflow.keras.models import Model
from tensorflow.keras.callbacks import ModelCheckpoint
from kaggle_datasets import KaggleDatasets
import transformers
import traitlets
import matplotlib.pyplot as plt
import seaborn as sns
from tqdm.notebook import tqdm
from tokenizers import BertWordPieceTokenizer
from sklearn.metrics import roc_auc_score

warnings.simplefilter(&quot;ignore&quot;)

# %% [markdown]
# ## Helper Functions

# %% [code]
def fast_encode(texts, tokenizer, chunk_size=256, maxlen=512):
    tokenizer.enable_truncation(max_length=maxlen)
    tokenizer.enable_padding(max_length=maxlen)
    all_ids = []
    
    for i in tqdm(range(0, len(texts), chunk_size)):
        text_chunk = texts[i:i+chunk_size].tolist()
        encs = tokenizer.encode_batch(text_chunk)
        all_ids.extend([enc.ids for enc in encs])
    
    return np.array(all_ids)

# %% [code]
def build_model(transformer, loss='binary_crossentropy', max_len=512):
    input_word_ids = Input(shape=(max_len,), dtype=tf.int32, name=&quot;input_word_ids&quot;)
    sequence_output = transformer(input_word_ids)[0]
    cls_token = sequence_output[:, 0, :]
    x = tf.keras.layers.Dropout(0.35)(cls_token)
    out = Dense(1, activation='sigmoid')(x)
    
    model = Model(inputs=input_word_ids, outputs=out)
    model.compile(Adam(lr=3e-5), loss=loss, metrics=[tf.keras.metrics.AUC()])
    
    return model

# %% [markdown]
# Cosine similarity calculates similarity by measuring the cosine of angle between two vectors. This is calculated as:
# ![](https://miro.medium.com/max/426/1*hub04IikybZIBkSEcEOtGA.png)
# 
# Cosine Similarity calculation for two vectors A and B [source]
# With cosine similarity, we need to convert sentences into vectors. One way to do that is to use bag of words with either TF (term frequency) or TF-IDF (term frequency- inverse document frequency). The choice of TF or TF-IDF depends on application and is immaterial to how cosine similarity is actually performed â€” which just needs vectors. TF is good for text similarity in general, but TF-IDF is good for search query relevance.

# %% [code]
# https://stackoverflow.com/questions/8897593/how-to-compute-the-similarity-between-two-text-documents
import nltk, string
from sklearn.feature_extraction.text import TfidfVectorizer

nltk.download('punkt') # if necessary...


stemmer = nltk.stem.porter.PorterStemmer()
remove_punctuation_map = dict((ord(char), None) for char in string.punctuation)

def stem_tokens(tokens):
    return [stemmer.stem(item) for item in tokens]

'''remove punctuation, lowercase, stem'''
def normalize(text):
    return stem_tokens(nltk.word_tokenize(text.lower().translate(remove_punctuation_map)))

vectorizer = TfidfVectorizer(tokenizer=normalize, stop_words='english')

def cosine_sim(text1, text2):
    tfidf = vectorizer.fit_transform([text1, text2])
    return ((tfidf * tfidf.T).A)[0,1]

# %% [markdown]
# ## TPU Configs

# %% [code]
AUTO = tf.data.experimental.AUTOTUNE

# Create strategy from tpu
tpu = tf.distribute.cluster_resolver.TPUClusterResolver()
tf.config.experimental_connect_to_cluster(tpu)
tf.tpu.experimental.initialize_tpu_system(tpu)
strategy = tf.distribute.experimental.TPUStrategy(tpu)

# Data access
#GCS_DS_PATH = KaggleDatasets().get_gcs_path('kaggle/input/') 

# %% [markdown]
# ## Create fast tokenizer

# %% [code]
# First load the real tokenizer
tokenizer = transformers.BertTokenizer.from_pretrained('bert-base-uncased')

# Save the loaded tokenizer locally
save_path = '/kaggle/working/distilbert_base_uncased/'
if not os.path.exists(save_path):
    os.makedirs(save_path)
tokenizer.save_pretrained(save_path)

# Reload it with the huggingface tokenizers library
fast_tokenizer = BertWordPieceTokenizer('distilbert_base_uncased/vocab.txt', lowercase=True)
fast_tokenizer

# %% [markdown]
# ## Load text data into memory

# %% [code]
train1 = pd.read_csv(&quot;/kaggle/input/jigsaw-multilingual-toxic-comment-classification/jigsaw-toxic-comment-train.csv&quot;)
train2 = pd.read_csv(&quot;/kaggle/input/jigsaw-multilingual-toxic-comment-classification/jigsaw-unintended-bias-train.csv&quot;)

valid = pd.read_csv('/kaggle/input/val-en-df/validation_en.csv')
test1 = pd.read_csv('/kaggle/input/test-en-df/test_en.csv')
test2 = pd.read_csv('/kaggle/input/jigsaw-multilingual-toxic-test-translated/jigsaw_miltilingual_test_translated.csv')
sub = pd.read_csv('/kaggle/input/jigsaw-multilingual-toxic-comment-classification/sample_submission.csv')

# %% [code]
test2.head()

# %% [markdown]
# ## Test dataset comparision

# %% [code]
plt.figure(figsize=(12, 8))

sns.distplot(train1.comment_text.str.len(), label='train')
sns.distplot(test1.content_en.str.len(), label='test1')
sns.distplot(test2.translated.str.len(), label='test2')
plt.legend();

# %% [code]
plt.figure(figsize=(12, 8))

sns.distplot(train1.comment_text.str.len(), label='train')
sns.distplot(test1.content_en.str.len(), label='test1')
sns.distplot(test2.translated.str.len(), label='test2')
plt.xlim([0, 512])
plt.legend();

# %% [markdown]
# Lets calculate cosine similarity two translated test datasets.

# %% [code]
test_set_similarity = [cosine_sim(t1, t2) for t1, t2 in tqdm(zip(test1.content_en, test2.translated))]

plt.figure(figsize=(12, 8))

sns.distplot(test_set_similarity);

# %% [markdown]
# ## Fast encode

# %% [code]
x_train = fast_encode(train1.comment_text.astype(str), fast_tokenizer, maxlen=512)
x_valid = fast_encode(valid.comment_text_en.astype(str), fast_tokenizer, maxlen=512)
x_test1 = fast_encode(test1.content_en.astype(str), fast_tokenizer, maxlen=512)
x_test2 = fast_encode(test2.translated.astype(str), fast_tokenizer, maxlen=512)

y_train = train1.toxic.values
y_valid = valid.toxic.values

# %% [markdown]
# ## Build datasets objects

# %% [code]
train_dataset = (
    tf.data.Dataset
    .from_tensor_slices((x_train, y_train))
    .repeat()
    .shuffle(2048)
    .batch(64)
    .prefetch(AUTO)
)

valid_dataset = (
    tf.data.Dataset
    .from_tensor_slices((x_valid, y_valid))
    .batch(64)
    .cache()
    .prefetch(AUTO)
)

test_dataset = [(
    tf.data.Dataset
    .from_tensor_slices(x_test1)
    .batch(64)
),
    (
    tf.data.Dataset
    .from_tensor_slices(x_test2)
    .batch(64)
)]

# %% [markdown]
# # Focal Loss

# %% [code]
from tensorflow.keras import backend as K

def focal_loss(gamma=2., alpha=.2):
    def focal_loss_fixed(y_true, y_pred):
        pt_1 = tf.where(tf.equal(y_true, 1), y_pred, tf.ones_like(y_pred))
        pt_0 = tf.where(tf.equal(y_true, 0), y_pred, tf.zeros_like(y_pred))
        return -K.mean(alpha * K.pow(1. - pt_1, gamma) * K.log(pt_1)) - K.mean((1 - alpha) * K.pow(pt_0, gamma) * K.log(1. - pt_0))
    return focal_loss_fixed

# %% [markdown]
# ## Load model into the TPU

# %% [code]
%%time
with strategy.scope():
    transformer_layer = transformers.TFBertModel.from_pretrained('bert-base-uncased')
    model = build_model(transformer_layer, loss=focal_loss(gamma=1.5), max_len=512)
model.summary()

# %% [markdown]
# ## RocAuc Callback

# %% [code]
from tensorflow.keras.callbacks import Callback 

class RocAucCallback(Callback):
    def __init__(self, test_data, score_thr):
        self.test_data = test_data
        self.score_thr = score_thr
        self.test_pred = []
        
    def on_epoch_end(self, epoch, logs=None):
        if logs['val_auc'] &gt; self.score_thr:
            print('\nRun TTA...')
            for td in self.test_data:
                self.test_pred.append(self.model.predict(td))

# %% [markdown]
# # LrScheduler

# %% [code]
def build_lrfn(lr_start=0.000001, lr_max=0.000002, 
               lr_min=0.0000001, lr_rampup_epochs=7, 
               lr_sustain_epochs=0, lr_exp_decay=.87):
    lr_max = lr_max * strategy.num_replicas_in_sync

    def lrfn(epoch):
        if epoch &lt; lr_rampup_epochs:
            lr = (lr_max - lr_start) / lr_rampup_epochs * epoch + lr_start
        elif epoch &lt; lr_rampup_epochs + lr_sustain_epochs:
            lr = lr_max
        else:
            lr = (lr_max - lr_min) * lr_exp_decay**(epoch - lr_rampup_epochs - lr_sustain_epochs) + lr_min
        return lr
    
    return lrfn

# %% [code]
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 7))

_lrfn = build_lrfn()
plt.plot([i for i in range(35)], [_lrfn(i) for i in range(35)]);

# %% [markdown]
# ## Train Model

# %% [code]
roc_auc = RocAucCallback(test_dataset, 0.9195)
lrfn = build_lrfn()
lr_schedule = tf.keras.callbacks.LearningRateScheduler(lrfn, verbose=1)

train_history = model.fit(
    train_dataset,
    steps_per_epoch=150,
    validation_data=valid_dataset,
    callbacks=[lr_schedule, roc_auc],
    epochs=35
)

# %% [markdown]
# ## Submission

# %% [code]
sub['toxic'] = np.mean(roc_auc.test_pred, axis=0)
sub.to_csv('submission.csv', index=False)

# %% [markdown]
# # Reference
# * [Jigsaw TPU: DistilBERT with Huggingface and Keras](https://www.kaggle.com/xhlulu/jigsaw-tpu-distilbert-with-huggingface-and-keras)
# * [inference of bert tpu model ml w/ validation](https://www.kaggle.com/abhishek/inference-of-bert-tpu-model-ml-w-validation)
# * [Overview of Text Similarity Metrics in Python](https://towardsdatascience.com/overview-of-text-similarity-metrics-3397c4601f50)
# * [test-en-df](https://www.kaggle.com/bamps53/test-en-df)
# * [val_en_df](https://www.kaggle.com/bamps53/val-en-df)
# * [Jigsaw multilingual toxic - test translated](https://www.kaggle.com/kashnitsky/jigsaw-multilingual-toxic-test-translated)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Latexç”»ç¥ç»ç½‘ç»œå›¾]]></title>
        <id>https://sunyanhust.github.io/post/latex-hua-shen-jing-wang-luo-tu/</id>
        <link href="https://sunyanhust.github.io/post/latex-hua-shen-jing-wang-luo-tu/">
        </link>
        <updated>2020-04-12T03:56:10.000Z</updated>
        <content type="html"><![CDATA[<h2 id="bilstm">BiLSTM</h2>
<h3 id="æ•ˆæœå›¾">ğŸ¥™æ•ˆæœå›¾</h3>
<figure data-type="image" tabindex="1"><img src="https://sunyanhust.github.io/post-images/1587243946926.png" alt="" loading="lazy"></figure>
<h3 id="ä»£ç ">ğŸ“œä»£ç </h3>
<pre><code class="language-tex">\documentclass[crop, tikz]{standalone}
\usepackage{tikz}

\usetikzlibrary{positioning}

\begin{document}
\begin{tikzpicture}
	\node[rectangle] (Y0) at (0, 0) {$\dots$};
	\node[rectangle, draw, right=2em of Y0, minimum height=1cm, minimum width=1cm] (RNN) {LSTM$_\rightarrow$};
	\node[rectangle, right=of RNN, draw, minimum height=1cm, minimum width=1cm] (RNN2) {LSTM$_\rightarrow$};
	\node[rectangle, right=of RNN2, draw, minimum height=1cm, minimum width=1cm] (RNN3) {LSTM$_\rightarrow$};
			
	\node[rectangle, right= of RNN3, draw, minimum height=1cm, minimum width=1cm] (RNN4) {LSTM$_\rightarrow$};
	\node[rectangle, right=2em of RNN4] (RNN5) {$\dots$};
			
			
	\node[rectangle, above=of RNN4, draw, minimum height=1cm, minimum width=1cm] (R25) {LSTM$_\leftarrow$};
	\node[rectangle, left=of R25, minimum height=1cm, minimum width=1cm, draw] (R24) {LSTM$_\leftarrow$};
	\node[rectangle, left=of R24, draw, minimum height=1cm, minimum width=1cm] (R23) {LSTM$_\leftarrow$};
	\node[rectangle, left=of R23, draw, minimum height=1cm, minimum width=1cm] (R22) {LSTM$_\leftarrow$};
	\node[rectangle, left=2em of R22] (R21) {$\dots$};
	\node[right=2em of R25] (Y20) {$\dots$};
			
	\node[below=of RNN] (X1) {$\vec{x}_1$};
	\node[below=of RNN2] (X2) {$\vec{x}_2$};
	\node[below=of RNN3] (X3) {$\vec{x}_3$};
	\node[below=of RNN4] (X4) {$\vec{x}_4$};
	\node[above=of R25] (Y5) {$\vec{h}_4$};
	\node[above=of R24] (Y4) {$\vec{h}_3$};
	\node[above=of R23] (Y3) {$\vec{h}_2$};
	\node[above=of R22] (Y2) {$\vec{h}_1$};
			
	\draw[-stealth, thick] (X1) -- (RNN);
	\draw[-stealth, thick] (X2) -- (RNN2);
	\draw[-stealth, thick] (X3) -- (RNN3);
	\draw[-stealth, thick] (X4) -- (RNN4);
	\draw[-stealth, thick, densely dotted] (Y0) -- (RNN);
	\draw[-stealth, thick] (RNN) -- node[above, pos=0.35] {$\vec{h}_2^\rightarrow$} (RNN2);
	\draw[-stealth, thick] (RNN2) -- node[above, pos=0.35] {$\vec{h}_3^\rightarrow$} (RNN3);
	\draw[-stealth, thick] (RNN3) -- node[above, pos=0.35] {$\vec{h}_4^\rightarrow$} (RNN4);
	\draw[-stealth, densely dotted, thick] (RNN4) -- (RNN5);
	\node[below=4em of Y0] (d) {\dots};
	\node[below=4em of RNN5] (d) {\dots};
			
	\path[-stealth, ultra thick, white] (X1) edge[bend left=45] (R22);
	\path[-stealth, thick] (X1) edge[bend left=45] (R22);
	\path[-stealth, ultra thick, white] (X2) edge[bend left=45] (R23);
	\path[-stealth, thick] (X2) edge[bend left=45] (R23);
	\path[-stealth, ultra thick, white] (X3) edge[bend left=45] (R24);
	\path[-stealth, thick] (X3) edge[bend left=45] (R24);
	\path[-stealth, ultra thick, white] (X4) edge[bend left=45] (R25);
	\path[-stealth, thick] (X4) edge[bend left=45] (R25);
	\draw[-stealth, densely dotted, thick] (Y20) -- (R25);
			
	\draw[-stealth, thick] (R22) -- (Y2);
	\draw[-stealth, thick] (R23) -- (Y3);
	\draw[-stealth, thick] (R24) -- (Y4);
	\draw[-stealth, thick] (R25) -- (Y5);
		
	\draw[stealth-, densely dotted, thick] (R21) -- (R22);
	\draw[stealth-, thick] (R22) -- node[above, pos=0.65] {$\vec{h}_3^\leftarrow$} (R23);
	\draw[stealth-, thick] (R23) -- node[above, pos=0.65] {$\vec{h}_4^\leftarrow$} (R24);
	\draw[stealth-, thick] (R24) -- node[above, pos=0.65] {$\vec{h}_5^\leftarrow$} (R25);
	\draw[-stealth, densely dotted, thick] (Y20) -- (R25);	
			
	\path[-stealth, ultra thick, white] (RNN) edge[bend right=45] (Y2);
	\path[-stealth, thick] (RNN) edge[bend right=45] (Y2);
	\path[-stealth, ultra thick, white] (RNN2) edge[bend right=45] (Y3);
	\path[-stealth, thick] (RNN2) edge[bend right=45] (Y3);
	\path[-stealth, ultra thick, white] (RNN3) edge[bend right=45] (Y4);
	\path[-stealth, thick] (RNN3) edge[bend right=45] (Y4);
	\path[-stealth, ultra thick, white] (RNN4) edge[bend right=45] (Y5);
	\path[-stealth, thick] (RNN4) edge[bend right=45] (Y5);
			
\end{tikzpicture}
\end{document}
</code></pre>
<h2 id="lstmå•å…ƒ">LSTMå•å…ƒ</h2>
<h3 id="æ•ˆæœå›¾-2">ğŸ¥™æ•ˆæœå›¾</h3>
<figure data-type="image" tabindex="2"><img src="https://sunyanhust.github.io/post-images/1587241071902.PNG" alt="" loading="lazy"></figure>
<h3 id="ä»£ç -2">ğŸ“œä»£ç </h3>
<pre><code class="language-tex">\documentclass[crop, tikz]{standalone}
\usepackage{tikz}

\usepackage{bm}
\usepackage{relsize}
\usepackage{pgfplots}
 
\usetikzlibrary{arrows,shapes, decorations.pathmorphing,backgrounds,positioning}

\begin{document}
\begin{tikzpicture}

	\node[rectangle, rounded corners=10, minimum width=20em, minimum height=12em, draw, very thick, fill=white] (lstm) at (0, 0) {};
	
	\node[rectangle, draw] at (-2.5, -0.8) (s1){$\sigma$};
	\node[rectangle, draw, right=1em of s1] (s2) {$\sigma$};
	\node[rectangle, draw, right=1em of s2] (t1) {$tanh$};
	\node[rectangle, draw, right=1em of t1] (s3) {$\sigma$};
	\node[circle, draw, above=2em of t1, inner sep=0em] (m1) {$\otimes$};
	\node[circle, draw, above=6em of s1, inner sep=0em] (m2) {$\otimes$};
	\node[circle, draw, right=6.55em of m2, inner sep=0em] (p1) {$\oplus$};
	\node[circle, draw, right=4.5em of m1, inner sep=0em] (m3) {$\otimes$};
	\node[rectangle, draw, above=1em of m3, inner sep=0.2em] (tt) {$tanh$ };
	
	\node[circle, draw, below=1em of s1, inner sep=0em] (conc) {$||$};
	
	\node[below=5em of s1] (xt) {$\vec{x}_t$};
	\node[left=3em of conc] (ht1) {$\vec{h}_{t-1}$};
	\node[left=3em of m2] (ct1) {$c_{t-1}$};
	\node[right=18em of m2] (ct) {$c_t$};
	\node[right=18em of conc] (ht) {$\vec{h}_t$};
	\node[] (yt) at (3, 3) {$\vec{h}_t$};
	
	\draw[-stealth, line width=1mm, white] (xt) -- (conc);
	\draw[-stealth, very thick] (xt) -- (conc);
	\draw[-stealth, line width=1mm, white] (ht1) -- (conc);
	\draw[-stealth, very thick] (ht1) -- (conc);
	
	\draw[-stealth, very thick] (conc) -- (s1);
	\path[-stealth, very thick] (conc) edge[bend right] (s2.south);
	\path[-stealth, very thick] (conc) edge[bend right] (t1.south);
	\path[-stealth, very thick] (conc) edge[bend right] (s3.south);
	\draw[-stealth, very thick] (s1) -- node[left] {$f_t$} (m2);
	\draw[-stealth, very thick] (s2) edge[bend left] node[above] {$i_t$} (m1.west);
	\draw[-stealth, very thick] (t1) -- node[right] {$\tilde{c_t}$} (m1);
	\draw[-stealth, very thick] (m1) -- (p1);
	\draw[-stealth, line width=1mm, white] (ct1) -- (m2);
	\draw[-stealth, very thick] (ct1) -- (m2);
	\draw[-stealth, very thick] (m2) -- (p1);
	\draw[-stealth, very thick] (s3) edge[bend left] node[left] {$o_t$} (m3.west);
	
	\draw[-stealth, line width=1mm, white] (p1) -- (ct);
	\draw[-stealth, very thick] (p1) -- (ct);
	\draw[-stealth, very thick] (tt) -- (m3);
	\draw[-stealth, line width=1mm, white] (m3) edge[bend right] (ht.west);
	\draw[-stealth, very thick] (m3) edge[bend right] (ht.west);
	
	\draw[-stealth ,very thick] (p1) edge[bend right] (tt.west);
	\draw[-stealth, line width=1mm,white] (m3) edge[bend right] (yt.south);
	\draw[-stealth, very thick] (m3) edge[bend right] (yt.south);
			
\end{tikzpicture}
\end{document}
</code></pre>
<h2 id="è‡ªæ³¨æ„åŠ›">è‡ªæ³¨æ„åŠ›</h2>
<h3 id="æ•ˆæœå›¾-3">ğŸ¥™æ•ˆæœå›¾</h3>
<figure data-type="image" tabindex="3"><img src="https://sunyanhust.github.io/post-images/1587241576659.png" alt="" loading="lazy"></figure>
<h3 id="ä»£ç -3">ğŸ“œä»£ç </h3>
<pre><code class="language-tex">\documentclass[crop, tikz]{standalone}
\usepackage{tikz}

\usetikzlibrary{positioning}

\begin{document}
\begin{tikzpicture}

	\node (X1) {$\vec{h}_{1}$};

	\node[rectangle, right= 0.5em of X1] (x_dots_1) {$\dots$};

	\node[right=0.5em of x_dots_1] (Xj) {$\vec{h}_{j}$};

	\node[rectangle, right= 1em of Xj] (x_dots_2) {$\dots$};

	\node[right=1em of x_dots_2] (Xn) {$\vec{h}_{n}$};

	\node[rectangle, draw, ultra thick, above=of X1] (attn1) {\large $a_\phi$};

	\node[rectangle, draw, ultra thick, above=of Xj] (attnj) {\large $a_\phi$};

	\node[rectangle, draw, ultra thick, above=of Xn] (attnn) {\large $a_\phi$};


	\draw[-stealth, thick] (X1) -- (attn1);
	\draw[-stealth, thick] (Xj) -- (attn1);

	\draw[-stealth, thick] (Xj) -- (attnj);
	\draw[-stealth, thick] ([xshift=3em]Xj) -- (attnj);
	
	\draw[-stealth, thick] (Xj) -- (attnn);
	\draw[-stealth, thick] (Xn) -- (attnn);
	
	\node[above= of attn1, opacity=0.2] (alpha1j) {$\alpha_{1,j}$};
	\node[above= of attnj, opacity=1] (alphajj) {$\alpha_{j,j}$};
	\node[above= of attnn, opacity=0.6] (alphanj) {$\alpha_{n,j}$};
	
	\node[circle, draw, above=of alpha1j] (times1) {$\times$};
	\node[circle, draw, above=of alphajj] (timesj) {$\times$};
	\node[circle, draw, above=of alphanj] (timesn) {$\times$};
	
	\node[rectangle, draw, above=of timesj] (sum) {$\Sigma$};

	\node[above=1em of sum] (x_tprim) {$\vec{h}_j'$};

	\draw[-stealth, line width=1.5mm, white] (attn1) -- (alpha1j);
	\draw[-stealth, thick, opacity=0.2] (attn1) -- (alpha1j);
	\draw[-stealth, line width=1.5mm, white] (attnj) -- (alphajj);
	\draw[-stealth, thick, opacity=1] (attnj) -- (alphajj);
	\draw[-stealth, line width=1.5mm, white] (attnn) -- (alphanj);
	\draw[-stealth, thick, opacity=0.6] (attnn) -- (alphanj);
	
	\draw[-stealth, white, line width=1.5mm] (X1) edge[bend right=30] (times1);
	\draw[-stealth, thick] (X1) edge[bend right=30] node[rectangle, draw, fill=white, midway] {$f_\psi$} (times1);
	\draw[-stealth, white, line width=1.5mm] (Xj) edge[bend right=30] (timesj);
	\draw[-stealth, thick] (Xj) edge[bend right=30] node[rectangle, draw, fill=white, midway] {$f_\psi$} (timesj);
	\draw[-stealth, thick] (Xn) edge[bend right=30] node[rectangle, draw, fill=white, midway] {$f_\psi$} (timesn);

	\draw[-, line width=1.5mm, white] (times1) -- (sum);
	\draw[-stealth, thick] (times1) -- (sum);
	\draw[-, line width=1.5mm, white] (timesj) -- (sum);
	\draw[-stealth, thick] (timesj) -- (sum);
	\draw[-stealth, thick] (timesn) -- (sum);
	\draw[-stealth, thick] (times1) -- (sum);
		
	\draw[-stealth, line width=1.5mm, white] (alpha1j) -- (times1);
	\draw[-stealth, thick, opacity=0.2] (alpha1j) -- (times1);
	\draw[-stealth, line width=1.5mm, white] (alphajj) -- (timesj);
	\draw[-stealth, thick, opacity=1] (alphajj) -- (timesj);
	\draw[-stealth, line width=1.5mm, white] (alphanj) -- (timesn);
	\draw[-stealth, thick, opacity=0.6] (alphanj) -- (timesn);

	\draw[-stealth, thick] (sum) -- (x_tprim);

\end{tikzpicture}
\end{document}
</code></pre>
<h2 id="rnn">RNN</h2>
<h3 id="æ•ˆæœå›¾-4">ğŸ¥™æ•ˆæœå›¾</h3>
<figure data-type="image" tabindex="4"><img src="https://sunyanhust.github.io/post-images/1587243725699.png" alt="" loading="lazy"></figure>
<h3 id="ä»£ç -4">ğŸ“œä»£ç </h3>
<pre><code class="language-tex">\documentclass[crop, tikz]{standalone}
\usepackage{tikz}

\usetikzlibrary{positioning}

\begin{document}
\begin{tikzpicture}
	\node[rectangle] (Y0) at (0, 0) {$\dots$};
	\node[rectangle, draw, right=2em of Y0, minimum height=1cm, minimum width=1cm] (RNN) {RNN};
	\node[rectangle, right=of RNN, draw, minimum height=1cm, minimum width=1cm] (RNN2) {RNN};
	\node[rectangle, right=of RNN2, draw, minimum height=1cm, minimum width=1cm] (RNN3) {RNN};
	\node[rectangle, right= of RNN3, draw, minimum height=1cm, minimum width=1cm] (RNN4) {RNN};
	\node[rectangle, right=2em of RNN4] (RNN5) {$\dots$};
			
	\node[below=of RNN] (X1) {$\vec{x}_1$};
	\node[below=of RNN2] (X2) {$\vec{x}_2$};
	\node[below=of RNN3] (X3) {$\vec{x}_3$};
	\node[below=of RNN4] (X4) {$\vec{x}_4$};
	\node[above=of RNN4] (Y5) {$\vec{h}_4$};
	\node[above=of RNN3] (Y4) {$\vec{h}_3$};
	\node[above=of RNN2] (Y3) {$\vec{h}_2$};
	\node[above=of RNN] (Y2) {$\vec{h}_1$};
			
	\draw[-stealth, thick] (X1) -- (RNN);
	\draw[-stealth, thick] (X2) -- (RNN2);
	\draw[-stealth, thick] (X3) -- (RNN3);
	\draw[-stealth, thick] (X4) -- (RNN4);
	
	\draw[-stealth, thick] (RNN) -- (Y2);
	\draw[-stealth, thick] (RNN2) -- (Y3);
	\draw[-stealth, thick] (RNN3) -- (Y4);
	\draw[-stealth, thick] (RNN4) -- (Y5);
	
    \draw[-stealth, densely dotted, thick] (Y0) -- (RNN);
    \draw[-stealth, densely dotted, thick] (RNN) -- (RNN2);
    \draw[-stealth, densely dotted, thick] (RNN2) -- (RNN3);
    \draw[-stealth, densely dotted, thick] (RNN3) -- (RNN4);
    \draw[-stealth, densely dotted, thick] (RNN4) -- (RNN5);
			
\end{tikzpicture}
\end{document}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[PaddleHubä½¿ç”¨ç¤ºä¾‹]]></title>
        <id>https://sunyanhust.github.io/post/paddlehub/</id>
        <link href="https://sunyanhust.github.io/post/paddlehub/">
        </link>
        <updated>2020-04-12T03:04:18.000Z</updated>
        <content type="html"><![CDATA[<p>æœ€è¿‘ç”¨äº†ä¸€ä¸‹PaddleHubï¼Œæ„Ÿè§‰è¿˜æŒºå¥½ç”¨çš„ã€‚è¿™é‡Œä¸¤ä¸ªä½¿ç”¨PaddleHubçš„ç¤ºä¾‹ã€‚</p>
<h2 id="åˆ†è¯">åˆ†è¯</h2>
<p>è¿™ä¸ªåˆ†è¯å’Œå®˜ç½‘çš„åˆ†è¯æ•ˆæœä¸€æ ·ï¼Œè§‰å¾—æ¯”jiebaä¹‹ç±»çš„è¦å¥½ã€‚</p>
<pre><code class="language-python"># pip install pyahocorasick
# https://www.paddlepaddle.org.cn/hubdetail?name=lac&amp;en_category=LexicalAnalysis
import paddlehub as hub

temp_user_dict = [
    dict(word='è‡ªç„¶', tag='n', freq='10000')
]


def make_dict(user_dicts):
    with open('user.dict', 'w') as f:
        for user_dict in user_dicts:
            f.write(user_dict['word'] + '\t' +
                    user_dict['tag'] + '\t' +
                    user_dict['freq'] + '\n')


make_dict(temp_user_dict)

lac = hub.Module(name='lac')
lac.set_user_dict(dict_path='user.dict')
results = lac.lexical_analysis(texts=['æˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†'],
                               use_gpu=False,
                               batch_size=1,
                               return_tag=True)

for result in results:
    print(result[&quot;word&quot;])
    print(result[&quot;tag&quot;])
</code></pre>
<h2 id="é˜…è¯»ç†è§£">é˜…è¯»ç†è§£</h2>
<pre><code class="language-python">import paddlehub as hub

module = hub.Module(name=&quot;roberta_wwm_ext_chinese_L-24_H-1024_A-16&quot;)
inputs, outputs, program = module.context(trainable=True, max_seq_len=384)
dataset = hub.dataset.CMRC2018()

reader = hub.reader.ReadingComprehensionReader(
    dataset=dataset,
    vocab_path=module.get_vocab_path(),
    max_seq_len=384)

strategy = hub.AdamWeightDecayStrategy(
    learning_rate=5e-5,
    weight_decay=0.01,
    warmup_proportion=0.1
)

config = hub.RunConfig(use_cuda=False, num_epoch=2, batch_size=12, strategy=strategy)
seq_output = outputs[&quot;sequence_output&quot;]

# feed_listçš„Tensoré¡ºåºä¸å¯ä»¥è°ƒæ•´
feed_list = [
    inputs[&quot;input_ids&quot;].name,
    inputs[&quot;position_ids&quot;].name,
    inputs[&quot;segment_ids&quot;].name,
    inputs[&quot;input_mask&quot;].name,
]

reading_comprehension_task = hub.ReadingComprehensionTask(
    data_reader=reader,
    feature=seq_output,
    feed_list=feed_list,
    config=config,
    sub_task=&quot;cmrc2018&quot;)

reading_comprehension_task.finetune_and_eval()

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¯¹å¾…å©šå§»çš„æ€åº¦]]></title>
        <id>https://sunyanhust.github.io/post/guan-yu-hun-yin/</id>
        <link href="https://sunyanhust.github.io/post/guan-yu-hun-yin/">
        </link>
        <updated>2020-04-06T13:42:02.000Z</updated>
        <content type="html"><![CDATA[<p>ä»Šå¤©æ™šä¸Šï¼Œå¾—çŸ¥æˆ‘æœ€å¥½çš„æœ‹å‹ç¦»å©šäº†ã€‚å­©å­æ‰1å²ï¼ŒåŒæ ·èº«ä¸ºçˆ¶äº²çš„æˆ‘æ„Ÿåˆ°éš¾è¿‡ï¼Œç¦»å©šå¯¹å­©å­æ¥è¯´å½±å“å¤ªå¤§ã€‚</p>
<p>æˆ‘æ²¡èµ„æ ¼è¯´è¿™äº›ã€‚ä¸è¿‡ï¼Œè‡³å°‘æˆ‘çš„å©šå§»ç®—å‡‘åˆï¼Œæˆ‘ä¹Ÿæœ‰æŠŠæ¡å»¶ç»­è¿™ç§å‡‘åˆã€‚æˆ‘å†™è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯å¸Œæœ›æœ‰æ›´å¤šçš„äººèƒ½æŠŠæ¡è‡ªå·±çš„å©šå§»ã€‚å°±ç®—æˆ‘è¯´çš„éƒ½æ˜¯åºŸè¯ï¼Œå¦‚æœèƒ½å¼•èµ·æœ‹å‹ä»¬åœ¨å©šå‰å¯¹å©šå§»å¤šä¸€äº›æ€è€ƒï¼Œå°±è¾¾åˆ°ç›®çš„äº†ã€‚</p>
<p>æ¯ä¸ªäººå¯¹å©šå§»çš„æ€åº¦éƒ½æ˜¯ä¸åŒçš„ï¼Œéšä¾¿æ‰¾ä¸ªäººè¿‡æ—¥å­çš„ï¼Œæ‰¾ä¸ªå¥³äººå¸®è‡ªå·±ç”Ÿå­©çš„ï¼Œæ‰¾ä¸ªè¿‡å¤œä¸æ”¶é’±çš„ï¼Œè¿™äº›æ‰€è°“çš„â€œå©šå§»â€å°±ä¸åœ¨è®¨è®ºèŒƒå›´äº†ï¼Œè¿™é‡Œå’Œå¤§å®¶è®¨è®ºçš„ï¼Œæ˜¯é«˜è´¨é‡çš„å©šå§»ã€‚</p>
<p>æ¯ä¸ªäººçš„ç†è§£éƒ½ä¸ä¸€æ ·ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå©šå§»çš„çŠ¶æ€æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯è®©äººèˆ’æœçš„å©šå§»ï¼Œä¸€å®šéƒ½æ˜¯æœ‰çˆ±çš„ã€‚</p>
<p>æœ‰äººè¯´ï¼Œçˆ±æƒ…æ˜¯æœ‰ä¿è´¨æœŸçš„ã€‚æˆ‘è¯´ï¼Œæœ‰ä¿è´¨æœŸçš„ä¸å«çˆ±æƒ…ã€‚é‚£å«æ¿€æƒ…ï¼Œæ¿€æƒ…å¤¹æ‚çš„ä¸œè¥¿å¤ªå¤šï¼Œæ€§æ¬²ï¼Œæ„ŸåŠ¨ï¼Œå†…ç–šï¼Œæ†§æ†¬ï¼Œæœ‰å¤ªå¤šå¤ªå¤šçš„æ‚è´¨ï¼Œè¿™æ ·çš„æƒ…æ„Ÿç¡®å®éš¾ä»¥æŒä¹…ã€‚ä½•å†µï¼Œæ¿€æƒ…å¾€å¾€æ˜¯ç²¾å¿ƒå‘µæŠ¤èµ·æ¥çš„ï¼Œä¸€æ—¦ä¸¢å¤±äº†ç²¾å¿ƒå‘µæŠ¤çš„åŠ¨åŠ›ï¼Œè¤ªè‰²å¤ªå¿«ã€‚</p>
<p>æ³¡å¦çš„æ—¶å€™ï¼Œæ¿€æƒ…æ˜¯æœ€å¥½çš„å·¥å…·ã€‚ç„¶è€Œé¢ä¸´ç»“å©šé€‰æ‹©æ—¶ï¼Œä½œä¸ºç”·äººï¼Œä¸€å®šè¦ç†æ¸…è‡ªå·±çš„å¤´è„‘ï¼Œç¥›é™¤æ¿€æƒ…çš„æˆåˆ†ã€‚è¿™ä¸ªæ€è€ƒçš„è¿‡ç¨‹éå¸¸é‡è¦ï¼Œå©šå§»æ˜¯æ²¡æœ‰å›å¤´è·¯çš„ã€‚åˆ«ä»¥ä¸ºå¤§ä¸äº†è¿˜å¯ä»¥ç¦»å©šã€‚ç¦»å©šä¸æ˜¯è§£è„±ï¼Œæ˜¯åˆä¸€ä¸ªéº»çƒ¦çš„å¼€å§‹ã€‚</p>
<p>å¦‚ä½•ç¡®å®šè‡ªå·±çˆ±ä¸çˆ±ä¸€ä¸ªå¥³äººï¼Œè¿™æ˜¯éå¸¸å…³é”®çš„ä¸€æ­¥ã€‚æˆ‘å¾ˆè‚¯å®šçš„è¯´ï¼Œå¾ˆå°‘ç”·äººæ¸…æ¥šè¿™ä¸ªé—®é¢˜ã€‚ç”·äººçš„ç”Ÿç†å¤©æ€§å†³å®šäº†å¯¹å¥³äººçš„é€‰æ‹©å¾ˆå¤§å› ç´ æ˜¯å¤–è²Œã€‚ä½†æ˜¯å©šå§»æ˜¯åäººç±»å¤©æ€§çš„ã€‚æ‰€ä»¥å½“ç”·äººé€‰æ‹©äº†å©šå§»ï¼Œå°±æ³¨å®šè¦å…‹æœè‡ªå·±çš„ç”Ÿç†å¤©æ€§ã€‚</p>
<p>ç”·äººçš„ç”Ÿç†å¤©æ€§ï¼Œè¯´ç™½å°±æ˜¯å¸Œæœ›ä¿è´¨ä¿é‡çš„é—ä¼ è‡ªå·±çš„åŸºå› ï¼Œæ¯”å¦‚å°½å¯èƒ½çš„å’Œæ›´å¤šå¥³äººä¸ŠåºŠï¼Œå°½å¯èƒ½çš„é€‰æ‹©æ›´æ¼‚äº®ï¼ŒåŸºå› æ›´ä¼˜ç§€çš„å¥³äººä¸ŠåºŠã€‚</p>
<p>è€Œå©šå§»ï¼Œæ°æ°ç›¸åï¼Œç”·äººåªèƒ½é€‰æ‹©ä¸€ä¸ªå¥³äººã€‚è€Œä¸”è¦çŸ¥é“ï¼Œçœ¼å‰è¿™ä¸ªå°†è¦å«ç»™è‡ªå·±çš„ç¾å¥³ï¼Œä¸å‡ å¹´å°±ä¼šç”Ÿå­©å­ï¼Œçœ¼è§’ä¼šæœ‰çš±çº¹ï¼Œä¹³æˆ¿ä¼šä¸‹å‚ï¼Œä¹³å¤´ä¼šå˜çš„å¾ˆé»‘ï¼Œå±è‚¡ä¼šå˜å½¢ï¼Œå°è‚šå­ä¼šå‡ºæ¥ï¼Œè¿˜ä¼šæœ‰éš¾çœ‹çš„æ–‘çº¹ã€‚æ›´å¯æ€•çš„æ˜¯ï¼Œç”·äººçš„ç”Ÿç†å¤©æ€§å†³å®šäº†ç”·äººè€å’ŒåŒä¸€ä¸ªå¥³äººä¸ŠåºŠï¼Œæ˜¯ä¼šè…»çš„ã€‚æ‰€ä»¥ï¼Œæ²¡æœ‰çˆ±çš„å©šå§»æ˜¯å±é™©çš„ã€‚å› ä¸ºæ²¡æœ‰å…‹æœç”Ÿç†æ¬²æœ›çš„ä¿¡å¿µã€‚</p>
<p>â€‹       å…„å¼Ÿä»¬æ°¸è¿œåˆ«åœ¨å©šå‰ä¿¡èª“æ—¦æ—¦çš„è¯´è‡ªå·±ä¸æ˜¯é‚£ç§åŒ…äºŒå¥¶çš„äººã€‚50å¹´ä»£å‡ºèº«é‚£æ‰¹äººï¼Œé“å¾·è§‚å¿µæ¯”æˆ‘ä»¬é‡çš„å¤šï¼Œè€å©†è¿˜éƒ½æ˜¯å…±è¿‡æ‚£éš¾çš„ç³Ÿç³ ï¼Œä¸ä¸€æ ·å¤§é‡çš„å‡ºè½¨ï¼Ÿæ‰€ä»¥ï¼Œåœ¨ä¸€å¤«ä¸€å¦»çš„åˆ¶åº¦ä¸‹ï¼Œä¿éšœå©šå§»çš„æ ¹æœ¬ï¼Œè¿˜æ˜¯å¾—ä¾é çˆ±æƒ…ã€‚å…¶ä»–çº¦æŸåœ¨äººæ€§æœ¬èƒ½çš„æ‹‰æ‰¯ä¸‹éƒ½æ˜¯è„†å¼±çš„ã€‚</p>
<p>æ®æˆ‘è§‚å¯Ÿï¼Œå¾ˆå¤šå¤±è´¥å©šå§»çš„å…ƒå‡¶å°±æ˜¯æ€§ã€‚æ€§å¯¹ç”·äººçš„è¯±æƒ‘æ˜¯è‡´å‘½çš„ï¼Œä¸å°‘ç”·äººå°±æ˜¯å› ä¸ºå’Œå¥³äººä¸Šäº†åºŠå°±é¡ºç†æˆç« çš„ç»“å©šäº†ã€‚æ˜¯å¥½æ˜¯åå…¨çœ‹è¿æ°”ã€‚å‹æ ¹ä¸æ€è€ƒæœ‰æ²¡æœ‰å…±åŒè¯­è¨€ï¼Œé‡åˆ°é—®é¢˜åŒæ–¹çš„æ²Ÿé€šæ–¹å¼å½¼æ­¤èƒ½å¦æ¥å—ï¼Œè¿™äº›å…³é”®çš„é—®é¢˜ä¸å»æƒ³ã€‚å°±å› ä¸ºä¸Šäº†åºŠå°±ç»“å©šã€‚è¿™æ˜¯å¾ˆå¤šæ‚²å‰§çš„æ¥æºã€‚ç”¨äººæ€§æœ¬èƒ½æ¥é€‚åº”åäººæ€§æœ¬èƒ½çš„å©šå§»åˆ¶åº¦ã€‚è¿™æ˜¯éå¸¸æ„šè ¢çš„ã€‚æ›´æ„šè ¢çš„æ˜¯å¾ˆå¤šå¥³äººä»¥æ€§ä¸ºå·¥å…·æ¥å¯¹å¾…å©šå§»ã€‚è¯´åˆ°è¿™é‡Œæ‰å‘ç°ï¼Œå©šå§»çœŸæ˜¯ä¸ªå¤§è¯é¢˜ã€‚æ¯ä¸ªäººå»é¢†ç»“å©šè¯çš„æ—¶å€™ï¼Œéƒ½æ²¡æƒ³è¿‡æœ‰ä¸€å¤©ä¼šå»æ‹¿ç¦»å©šè¯ã€‚å¯æƒœï¼Œç¦»å©šçš„äººè¶Šæ¥è¶Šå¤šã€‚æ®ç»Ÿè®¡80åçš„ç¦»å©šç‡å¿«åˆ°ç™¾åˆ†å››åäº†ã€‚</p>
<p>ç”·äººï¼Œåªæœ‰æŠŠæ€§æ¬²ï¼Œæ„ŸåŠ¨ç­‰ç­‰ç­‰ç­‰å› ç´ å…¨æŠ›å¼€ï¼Œæ‰èƒ½çœŸæ­£è®¤è¯†è‡ªå·±å¯¹ä¸€ä¸ªå¥³äººçš„æ„Ÿæƒ…æ˜¯ä¸æ˜¯çˆ±ã€‚çˆ±ä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä½†æ˜¯èƒ½ç»™ç”·äººè§£å†³é—®é¢˜çš„åŠ¨åŠ›ã€‚æ²¡æœ‰åŠ¨åŠ›ç»è¥çš„å©šå§»ï¼Œéº»çƒ¦å¾ˆå¤šã€‚å› ä¸ºå©šå§»çš„é—®é¢˜å¾ˆå¤šã€‚</p>
<p>ç»“å©šå¯¹ç”·äººè€Œè¨€ï¼Œçº¯ç²¹æ˜¯è´£ä»»ã€‚æœ‰äº†æ‰¿æ‹…è´£ä»»çš„å†³å¿ƒï¼Œæ‰æ•¢è°ˆå©šå§»ï¼Œæ‰€ä»¥ï¼Œç»“å©šä¸€å®šè¦æ‰¾ä¸€ä¸ªè‡ªå·±çˆ±çš„å¥³äººã€‚è‡ªå·±ä½™ä¸‹çš„ç”Ÿå‘½å…¨éƒ¨ä¸ºä¹‹ä»˜å‡ºçš„å®¶åº­ï¼Œå¥³ä¸»äººä¸æ˜¯è‡ªå·±çœŸæ­£çˆ±çš„ï¼Œå¤ªæ‚²å‰§äº†ã€‚å› ä¸ºå©šå§»å”¯ä¸€èƒ½å›æŠ¥ç»™ç”·äººçš„ï¼Œä»…ä»…æ˜¯ä¸€åªèƒ½ç‰µç€è‡ªå·±èµ°å‘æ­»äº¡çš„æ‰‹ã€‚åƒä¸‡åˆ«å¥¢æœ›å©šå§»å›æŠ¥ç»™è‡ªå·±ä»€ä¹ˆï¼Œä»»ä½•å¥¢æœ›åªä¼šæ·»åŠ åŒæ–¹çš„å‹åŠ›ã€‚åšå¥½ä¸ˆå¤«è¯¥åšçš„ï¼Œè‡ªç„¶å¾—åˆ°åº”å¾—çš„ã€‚</p>
<p>å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œä¸æ˜¯å¹³æ—¶æœ‰æ²¡æœ‰å…±åŒè¯­è¨€ï¼Œè€Œæ˜¯æœ‰åˆ†æ­§å’Œé—®é¢˜çš„æ²Ÿé€šã€‚è¯´ç™½äº†ï¼Œå¦‚æœç”·äººæ˜¯ä¸ªè®²é“ç†çš„äººï¼Œå¥³äººä¹Ÿå¾—æ˜¯ä¸ªæ‡‚é“ç†çš„äººï¼Œå¦‚æœç”·äººæ˜¯ä¸ªå–œæ¬¢ç”¨æ‹³å¤´è¯´è¯çš„äººï¼Œå¥³äººä¹Ÿå¾—æ˜¯ä¸ªè‚¯æŒ¨æ‹³å¤´çš„äººã€‚å¥³äººå¦‚æœå–œæ¬¢å” å¨ï¼Œç”·äººå°±å¾—å¬å¾—æƒ¯ã€‚æ€»ä¹‹ï¼Œä¸¤ä¸ªäººå¿…é¡»å¾—æœ‰ä¸ªæ‹¿å‡ºç»Ÿä¸€æ„è§çš„ç¨‹åºï¼Œä¸”åŒæ–¹éƒ½èƒ½æ¥å—ã€‚æœ€å¥½æ˜¯éƒ½ä¹æ„æ¥å—ã€‚å…¶å®è¿™ä¸€æ¡å¯¹äºçœŸæ­£ç›¸çˆ±çš„äººæ¥è®²ä¸æ˜¯é—®é¢˜ï¼ŒçœŸæ­£ç›¸çˆ±çš„ä¸¤ä¸ªäººæ°¸è¿œæ˜¯ç«™åœ¨å¯¹æ–¹ç«‹åœºæ€è€ƒé—®é¢˜çš„ã€‚</p>
<p>æœ‰æƒ…é¥®æ°´é¥±ï¼Œåªèƒ½é¥±ä¸€é¡¿ã€‚ç”·äººæ²¡ç»“å©šï¼Œæ˜¯æ½‡æ´’çš„ï¼Œä¸€ç»“å©šï¼Œè´Ÿæ‹…å°±æ¥äº†ã€‚ä¸¤ä¸ªäººçš„ç»“åˆæ‰€å¸¦çš„å‹åŠ›è‚¯å®šæ˜¯å·¨å¤§çš„ï¼Œå¿…é¡»è¦è€ƒè™‘åŒæ–¹çš„æ‰¿å—èƒ½åŠ›ï¼Œè‡ªå·±æ²¡æœ‰èƒ½åŠ›è´Ÿæ‹…ï¼Œå°±ä¸è¦å®³äººå®³å·±äº†ã€‚å¥³æœ‹å‹å¦‚æœå–œæ¬¢é’±ï¼Œæœ‰é’±å°±å¨¶ï¼Œæ²¡é’±å°±ä¸è¦ç ¸é”…å–é“å¨¶å›å®¶äº†ã€‚</p>
<p>æœ‰äº›è´Ÿæ‹…ï¼ŒèƒŒä¸Šå°±æ˜¯ä¸€è¾ˆå­çš„ã€‚å¯¹å©šå§»è€Œè¨€ï¼Œè‚¯é™ªè‡ªå·±ä¸€èµ·å¥‹æ–—çš„å¥³äººï¼Œæ‰çœŸæ­£åº”è¯¥çæƒœã€‚å•å•æ˜¯ä¸¤ä¸ªäººä¸€èµ·æ”¹å–„ç”Ÿæ´»çš„è¿‡ç¨‹ï¼Œå°±å·²ç»æ˜¯å©šå§»å®è´µçš„è´¢å¯Œäº†ã€‚åˆ«è¯´ç°åœ¨è¿™æ ·çš„å¥³äººå°‘ï¼Œä¸å°‘ã€‚è€ç›¯ç€èŠ±ææ‹›å±•æƒ³é å«äººæ”¹å˜å‘½è¿çš„å¹´è½»å¥³äººï¼Œå°±åˆ«æ€ªå¥³äººç°å®ã€‚è‡ªå·±ä»æœªè§„åˆ’è¿‡æœªæ¥ï¼Œå°±åˆ«æ€ªå¥³äººä¸è‚¯é™ªè‡ªå·±ä¸€èµ·å¥‹æ–—ã€‚</p>
<p>æˆ‘ä¸€ç›´æå€¡å©šå‰æ€§è¡Œä¸ºï¼Œæ€§ç”Ÿæ´»å¾—åˆ°æ»¡è¶³çš„ç”·äººï¼Œæ‰æ›´å®¹æ˜“å‘ç°å¥³äººå…¶ä»–çš„é­…åŠ›ã€‚è€Œç°å®çš„æƒ…å†µæ˜¯ï¼Œä¸å°‘å¥½å¥³äººè¿˜å‰©ç€ï¼Œç”·äººå´åœ¨è¿½é€æ€§çš„è¿‡ç¨‹ä¸­è¿·å¤±äº†è‡ªå·±ã€‚å› è‰²è€Œç»“åˆï¼Œå¥³äººè‰²è¡°ä¹‹åï¼Œæ²¡æœ¬äº‹çš„ç”·äººç»§ç»­é¬¼æ··ï¼Œæœ‰æœ¬äº‹çš„æ¢ä¸ªå¥³äººå‡‘åˆã€‚è¿™æ ·çš„é£æ°”è¿˜æœ‰ä¸ªå¾ˆçƒ¦çš„å½±å“ï¼Œå¥³äººè¶Šæ¥è¶Šåœ¨æ„è‡ªå·±çš„å½¢è±¡ï¼ŒåŒ–å¦†æ—¶é—´è¶Šæ¥è¶Šé•¿ï¼Œè¡£é¢†è¶Šæ¥è¶Šä½ï¼Œè£™å­è¶Šæ¥è¶ŠçŸ­ã€‚è€Œå……ç”µçš„æ—¶é—´è¶Šæ¥è¶Šå°‘ï¼Œç‹¬ç«‹æ„è¯†è¶Šæ¥è¶Šæ·¡ã€‚</p>
<p>ç”·äººä¸€è¾¹è¿½é€å¥³è‰²ï¼Œä¸€è¾¹æŠ±æ€¨å¥³äººç´ è´¨è¶Šæ¥è¶Šä½ã€‚</p>
<p>å¥³äººå‘¢ï¼Ÿä¸€è¾¹æŠ±æ€¨ç”·äººè‚¤æµ…ï¼Œä¸€è¾¹ä¸æ–­è¿åˆè‚¤æµ…çš„å®¡ç¾ã€‚</p>
<p>å©šå§»ä¸æ˜¯äººç”Ÿçš„å…¨éƒ¨ï¼Œä¸¤ä¸ªäººæºæ‰‹ä¸€ç”Ÿï¼Œç›¸åŠ©åˆ™åˆ©ï¼Œç›¸é˜»åˆ™æŸã€‚æ€§æ ¼äº’è¡¥ä¹Ÿå¥½ï¼Œå¿—åŒé“åˆä¹Ÿå¥½ï¼Œå½¼æ­¤æˆä¸ºå¯¹æ–¹çš„åŠ©åŠ›ï¼ŒçœŸçš„å¾ˆé‡è¦ã€‚å¦‚æœå’Œä¸€ä¸ªå¥³äººå©šå‰å°±æ„Ÿè§‰ç–²æƒ«ã€‚ç›¸ä¿¡æˆ‘ï¼Œåˆ«ç»“å©šäº†ã€‚å®¶æ˜¯æ¸¯æ¹¾ï¼Œæ˜¯ä¸€ä¸ªè®©ç”·äººå¿«åˆ°å®¶é—¨å°±ä¼šä¸è‡ªè§‰åŠ å¿«è„šæ­¥çš„åœ°æ–¹ã€‚æ˜¯ä¸€ä¸ªä¸€å›å®¶å°±ä¼šå½»åº•æ”¾æ¾ï¼Œå¸ä¸‹æ‰€æœ‰ä¼ªè£…çš„åœ°æ–¹ã€‚æ˜¯ä¸€ä¸ªæ‰€æœ‰ç¬‘å®¹éƒ½å‘è‡ªçœŸå¿ƒçš„åœ°æ–¹ã€‚</p>
<p>æ€æ ·åŒºåˆ†æ¿€æƒ…å’Œçˆ±æƒ…ï¼Ÿå…¶å®å¾ˆå¥½åŒºåˆ†çš„ï¼Œå½“ä½ ä¸è§å¥¹æ—¶èŒ¶é¥­ä¸æ€ï¼Œæ˜¯æ¿€æƒ…ã€‚è€æƒ³è§åˆ°å¥¹ï¼Œæƒ³å’Œå¥¹ä¸€èµ·ç©ï¼Œä¸€èµ·ä¸ŠåºŠï¼Œä¸€èµ·åšç™½æ—¥æ¢¦ï¼Œæ˜¯æ¿€æƒ…ã€‚æ¯å¤©çŸ­ä¿¡ç”µè¯å¤šçš„æ²¡å®Œï¼Œæ˜¯æ¿€æƒ…ã€‚ä¸ºäº†ç”Ÿæ—¥èŠ‚æ—¥è´¹å°½å¿ƒæ€æƒ³æµªæ¼«çš„ç‚¹å­ï¼Œæ˜¯æ¿€æƒ…ã€‚</p>
<p>å½“ä½ å’Œå¥¹åœ¨ä¸€èµ·æ—¶è„‘å­é‡Œä¸è‡ªè§‰çš„è§„åˆ’å®å®åœ¨åœ¨çš„å°†æ¥ï¼Œæ˜¯çˆ±æƒ…ã€‚å½“ä½ ä»¬äº‰åµåˆ°å¾ˆå‡¶ï¼Œç«å¾ˆå¤§æ—¶ï¼Œä¹Ÿä¸å¿å¿ƒè¯´ä¸€å¥ä¼¤å®³å¥¹çš„è¯ï¼Œæ˜¯çˆ±æƒ…ã€‚å½“ä½ ä»¬æœ‰åˆ†æ­§æ—¶ï¼Œä½ æ€»æ˜¯èƒ½æ¸…æ¥šçš„çŸ¥é“å¥¹æ˜¯æ€ä¹ˆæƒ³çš„ï¼Œèƒ½ç†è§£å¥¹çš„åˆè¡·ï¼Œæ˜¯çˆ±æƒ…ã€‚</p>
<p>ç°åœ¨å¾ˆå¤šäººè°ˆæ‹çˆ±å¾ˆçŸ­æ—¶é—´å°±ç»“å©šäº†ï¼Œå½“ç„¶ï¼Œä¸æ˜¯è¯´æ—¶é—´çŸ­å°±ä¸å¥½ï¼Œè€Œæ˜¯è¦æ¸…æ¥šçš„çŸ¥é“ï¼Œå©šå‰çš„è€ƒå¯Ÿå¯¹è¿™ä¸€ç”Ÿçš„å½±å“ã€‚å¤±è´¥çš„å®¶åº­æ˜¯ä»»ä½•æˆåŠŸéƒ½å¼¥è¡¥ä¸äº†çš„ã€‚</p>
<p>äººï¼Œä¸€æ—¦ç¦»è¿‡ä¸€æ¬¡å©šï¼Œå†å¯»æ‰¾å¹¸ç¦çš„éš¾åº¦å°±æ›´å¤§äº†ã€‚å› ä¸ºï¼Œç¦»è¿‡å©šçš„äººæ›´éš¾ç›¸ä¿¡çˆ±æƒ…ã€‚æ›´ä½•å†µç¦»å©šå¯¹å­å¥³çš„å½±å“ï¼Œå¤ªå¤§å¤ªå¤§ã€‚äººï¼ŒçœŸæ­£èƒ½ç•™åœ¨è¿™ä¸ªä¸–ç•Œä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯å­å¥³è¿™ç‚¹è¡€è„‰è€Œå·²ã€‚ä¸ºå­å¥³è¥é€ ä¸€ä¸ªå¥½çš„æˆé•¿ç¯å¢ƒï¼Œæ˜¯çˆ¶äº²çš„è´£ä»»ã€‚</p>
<p>å‰é¢è¯´è¿™ä¹ˆå¤šå…¶å®éƒ½æ˜¯è¯´é¢å¯¹å©šå§»çš„æ€åº¦è¦ç†æ€§ï¼Œè¦æ…é‡ã€‚</p>
<p>æ€åº¦ç«¯æ­£ä»¥åï¼ŒæŠ€å·§ä¹Ÿæœ‰å¾ˆå¤šéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚æ˜æ˜ç›¸çˆ±çš„ä¸¤ä¸ªäººäº’ç›¸ä¼¤å®³çš„äº‹æƒ…å¤ªå¤šäº†ã€‚å¦‚æœçŠ¯é”™ï¼Œä¹Ÿè¦ç§¯ææƒ³åŠæ³•è¡¥æ•‘äº‰å–ã€‚ä¼¤å¯’å¿ƒæ•£ä¼™çš„ä¹Ÿå¤šï¼Œè€Œä¸”å©šå§»ç”Ÿæ´»ï¼Œç”·äººè¿˜æœ‰ä¸ªé‡è¦æŠ€æœ¯è¦æŒæ¡ï¼Œå°±æ˜¯è€å¦ˆä¸è€å©†çš„å…³ç³»ã€‚å©šåç”Ÿæ´»çç¢çš„äº‹æƒ…å¤ªå¤šï¼Œå…ˆè¯´è¯´å¤„ç†å©†åª³å…³ç³»ã€‚æ‰€æœ‰è¿˜æ²¡ç»“å©šçš„å…„å¼Ÿä¸€å®šä¸è¦æŠŠè¿™ä¸å½“ä¸€å›äº‹ã€‚ä¸€è¾¹æ˜¯ç”Ÿä½ å…»ä½ ä¸ºä½ ä»˜å‡ºæ‰€æœ‰çš„æ¯äº²ï¼Œä¸€è¾¹æ˜¯å°†è¦ç›¸ä¼´ä½ ä¸€ç”Ÿçš„è€å©†ã€‚åŒæ–¹éƒ½æœ‰è´£ä»»è¦ç…§é¡¾ã€‚è¿™ä¸ªå…³ç³»å¼„é¡ºäº†ï¼Œå°‘å¾ˆå¤šéº»çƒ¦ã€‚</p>
<p>æœ‰äººè¯´ç”·äººåœ¨å©†åª³ä¹‹é—´æ˜¯åŒé¢èƒ¶ï¼Œå¤¹åœ¨ä¸­é—´ä¸¤é¢è®¨å¥½ã€‚è¿™æ˜¯é”™çš„ã€‚ç”·äººå¿…é¡»æ˜¯ä¸€æ‰‹æ‹¿æ£’ä¸€æ‰‹æ‹¿æ¶¦æ»‘æ²¹ã€‚å°äº‹å±…ä¸­è°ƒèŠ‚ï¼ŒåŸåˆ™é—®é¢˜å¯¹äº‹ä¸å¯¹äººï¼Œé“ç†ç»ä¸èƒ½æ­ªï¼Œæ—¢ä¸èƒ½çºµå®¹åª³å¦‡ï¼Œä¹Ÿä¸èƒ½æƒ¯åäº†è€å¦ˆã€‚åšå†³ä¸è¦åœ¨è€å¦ˆé¢å‰è¯´åª³å¦‡ä¸å¯¹ï¼Œå¤šåŒ…æ¶µä¹‹ç±»ï¼Œä¹Ÿä¸èƒ½åœ¨åª³å¦‡é¢å‰è¯´ï¼Œè¿™éƒ½æ˜¯çºµå®¹ã€‚æŠŠæ¡ä¸€ä¸ªåŸåˆ™ï¼Œç»ä¸å…è®¸åª³å¦‡åœ¨è‡ªå·±é¢å‰è¯´è€å¦ˆçš„åè¯ï¼Œæœ‰äº‹è¯´äº‹ã€‚è¯¥æ€ä¹ˆè§£å†³æ€ä¹ˆè§£å†³ï¼Œæ˜¯è€å¦ˆä¸å¯¹ä¹Ÿè¦å’Œè€å¦ˆæŠŠäº‹æƒ…è®²æ¸…æ¥šï¼ŒåŒæ ·çš„ï¼Œè€å¦ˆè¯´è‡ªå·±åª³å¦‡çš„æ—¶å€™ä¹Ÿè¦åˆ†æ¸…æ˜¯éã€‚å±…ä¸­è®¨å¥½çš„åæœæ˜¯ä¸¤é¢ä¸æ˜¯äººï¼ŒçŸ›ç›¾è¿˜è¶Šæ¥è¶Šæ·±ã€‚</p>
<p>æ€»ä¹‹ï¼Œç»å¯¹çš„å…¬å¹³æ˜¯å¤„ç†å©†åª³å…³ç³»çš„å”¯ä¸€æ–¹å¼ï¼Œå§”å±ˆä»»ä½•ä¸€æ–¹ï¼Œéƒ½ä¼šä½¿çŸ›ç›¾æ¿€åŒ–ã€‚å¦ˆä¹Ÿå¥½ï¼Œè€å©†ä¹Ÿå¥½ï¼Œåº•çº¿éƒ½ç»™å¥¹ä»¬ç”»å¥½ã€‚äººéƒ½æ˜¯æœ‰é€‰æ‹©æ€§çš„ï¼Œæ—¢ç„¶è¦ä¸åˆ°ç‰¹æƒï¼Œè‡ªç„¶ä¼šæ³¨æ„å½¼æ­¤ç›¸å¤„ã€‚ä¸€å¼€å§‹å¯èƒ½ç”·äººæ—¥å­ä¸å¤ªå¥½è¿‡ï¼Œä¸¤è¾¹éƒ½è¦æ–—ä¸Šå‡ æ¬¡ã€‚ä½†æ˜¯æ…¢æ…¢çš„ï¼Œå®¶åº­ç§©åºå°±ä¼šèµ°ä¸Šæ­£è½¨ã€‚ å¦‚æœä¸€å¼€å§‹å›¾çœå¿ƒï¼Œå“„è¿‡å»ï¼Œä¸¤è¾¹è„¾æ°”éƒ½å…»å¤§äº†å°±å¤Ÿè‡ªå·±å—äº†ã€‚ï¼ˆå‰é¢å¿˜äº†è¯´äº†ï¼Œæ‰¾å¥³äººä¸€å®šè¦æ‰¾ä¸ªèªæ˜çš„ï¼Œç¬¨å¥³äººå¤šå¾ˆå¤šéº»çƒ¦ï¼Œèªæ˜çš„å¥³äººè‡ªå·±ä¼šå¤„ç†ï¼Œè‡ªå·±åªç”¨æ‰“æ‰“ä¸‹æ‰‹ï¼Œå…³ç³»å°±å¤„çš„å¾ˆå¥½äº†ã€‚ï¼‰</p>
<p>è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å­å¥³ï¼Œç°åœ¨çš„å­©å­æ‰çœŸå«ä¸€ä¸ªå®è´ï¼Œä¸€å¤§å®¶äººå›´ç€è½¬ï¼Œå„æœ‰å„çš„ä¸»æ„ï¼Œå¾ˆå¤šçŸ›ç›¾éƒ½æ˜¯å› æ­¤è€Œèµ·ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œç”·äººä¸€å®šè¦å¼ºç¡¬ï¼Œä»ä¸€å¼€å§‹å°±ç»å¯¹ä¸èƒ½è®©æ­¥ï¼Œè¦ç»™å‡ºæ˜ç¡®çš„ä¿¡å·ï¼Œå­©å­æ˜¯è‡ªå·±çš„ã€‚åŒæ–¹çˆ¶æ¯è‚¯å¸®å¿™ï¼Œæ„Ÿè°¢ã€‚ä½†æ˜¯æ¶‰åŠå­©å­çš„ä¸€åˆ‡å†³å®šã€‚å¿…é¡»æ˜¯è‡ªå·±æ‹¿ä¸»æ„ã€‚ï¼ˆè¿™ä¸€ç‚¹èƒŒåœ°é‡Œå¯ä»¥å¤šå¬è€å©†çš„ï¼Œæ¯•ç«Ÿï¼Œå¦ˆå¦ˆæ˜¯æœ€çˆ±å­©å­çš„ã€‚ï¼‰è¿™ä¸€ç‚¹ç”³æ˜å°¤å…¶é‡è¦ï¼Œç›¸å½“äºè‡ªå·±ä¸€ä¸ªäººæŠŠæ‰€æœ‰ç‚®ç«æ½äº†ã€‚å¦åˆ™ï¼Œå­©å­ä¸€ç‚¹ç‚¹å°æ„Ÿå†’å®¶é‡Œå¯ä»¥é—¹ç¿»å¤©ã€‚ï¼ˆæˆ‘é‚£ä»Šå¤©ç¦»å©šçš„æœ‹å‹å°±æ˜¯å› ä¸ºè¿™ä¸ªï¼‰ã€‚</p>
<p>å©šå§»ç¡®å®æ˜¯ä¸ªå¤§è¯é¢˜ï¼Œä¸€æ—¶åè€Œä¸çŸ¥é“è¯´ä»€ä¹ˆå¥½äº†ï¼Œæˆ‘æ˜¯çœŸå¿ƒæƒ³å’Œå¤§å®¶äº¤æµä¸€ä¸‹ã€‚å› ä¸ºæˆ‘è‡ªè®¤ä¸ºè‡ªå·±çš„å©šå§»çœŸçš„æ˜¯ç§å¹¸ç¦ã€‚æˆ‘æ˜¯çœŸå¿ƒå¸Œæœ›æœ‰æ›´å¤šçš„äººèƒ½æ„‰å¿«çš„äº«å—å©šå§»ã€‚æœ‰äººè¯´ä¸åµæ¶ä¸ç®—å¤«å¦»ï¼Œè¯´çœŸçš„ï¼Œæˆ‘å’Œæˆ‘è€å©†çœŸè¿˜åµä¸èµ·æ¥æ¶ï¼Œå°±åƒæˆ‘å‰é¢è¯´çš„ï¼Œä¼¤å½¼æ­¤çš„è¯ç¡®å®ä¸å¿å¿ƒè®²å‡ºå£ã€‚ä½•å†µä¸€æ—¦æ¸…æ¥šå½¼æ­¤éƒ½æ˜¯å‡ºäºçˆ±ï¼Œåˆæœ‰ä»€ä¹ˆå¥½åµçš„ï¼Ÿæœ‰å‡ æ¬¡åˆšè¿›å…¥çŠ¶æ€ï¼Œçœ‹è§å½¼æ­¤è£…è…”ä½œåŠ¿ç”Ÿæ°”çš„æ ·å­å°±éƒ½ç¬‘äº†ã€‚</p>
<p>512åœ°éœ‡çš„æ—¶å€™ï¼Œæˆ‘åœ¨éœ‡åŒºï¼Œè¿™ä¹ˆå¤§çš„åŸå¸‚ï¼Œé€šè®¯ä¸­æ–­çš„æƒ…å†µä¸‹ï¼Œæˆ‘ç¬¬ä¸€æ—¶é—´è§åˆ°äº†æˆ‘çš„è€å©†ï¼Œä¸åœ¨æˆ‘ä»¬ä¸Šç­çš„é™„è¿‘ï¼Œä¹Ÿä¸åœ¨æˆ‘ä»¬å®¶é™„è¿‘ï¼Œè€Œæ˜¯åœ¨æˆ‘çˆ¶æ¯çš„å®¶é—¨å£ã€‚å¥¹çŸ¥é“ä½“è°…æˆ‘æ‹…å¿ƒçˆ¶æ¯çš„å¿ƒæƒ…ï¼Œæˆ‘çŸ¥é“å¥¹èƒ½ä½“è°…æˆ‘ã€‚è¿™å°±æ˜¯å©šå§»çš„é»˜å¥‘ã€‚ä¹Ÿæ˜¯å©šå§»å’Œæ‹äººçš„åŒºåˆ«ï¼Œå©šå§»æ‰¿è½½çš„æ›´å¤šã€‚</p>
<p>æ‹äººæ—¶åˆ»åªæœ‰ç”œèœœå’Œæµªæ¼«ï¼Œè€Œå©šå§»åˆ™æ›´å¤šæ˜¯è´£ä»»å’Œå¹³æ·¡ï¼Œè¿™ä¸ªè½¬åŒ–çš„è¿‡ç¨‹ï¼Œæ˜¯éœ€è¦åŒæ–¹æœ‰å……è¶³æ€æƒ³å‡†å¤‡çš„ã€‚å…¶å®åªè¦ä¸¤ä¸ªäººè‚¯ä¸€èµ·é¢å¯¹ï¼Œå©šå§»ç”Ÿæ´»å¹³æ·¡ä¸­çš„å¹¸ç¦å¹¶ä¸è¾“ç»™çƒ­æ‹æ—¶çš„æµªæ¼«ã€‚</p>
<blockquote>
<p>è½¬è½½åœ¨<a href="https://www.zhihu.com/question/19732277/answer/1056367198">çŸ¥ä¹</a></p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[nvidia-smiæŒ‡ä»¤æŠ¥é”™ï¼šFailed to initialize NVML: Driverè§£å†³]]></title>
        <id>https://sunyanhust.github.io/post/nvidia-smi-zhi-ling-bao-cuo-failed-to-initialize-nvml-driver-jie-jue/</id>
        <link href="https://sunyanhust.github.io/post/nvidia-smi-zhi-ling-bao-cuo-failed-to-initialize-nvml-driver-jie-jue/">
        </link>
        <updated>2020-04-05T15:18:44.000Z</updated>
        <content type="html"><![CDATA[<p>æœ€è¿‘è£…æ·±åº¦å­¦ä¹ ç¯å¢ƒçš„æ—¶å€™é‡è§çš„ï¼Œä¸»è¦åŸå› æ˜¯æ—§çš„æ˜¾å¡é©±åŠ¨æ²¡å¸è½½ã€‚</p>
<p>é¦–å…ˆéœ€è¦å¸è½½é©±åŠ¨</p>
<pre><code class="language-shell">sudo apt-get purge nvidia*
</code></pre>
<p>ç„¶åé‡æ–°å®‰è£…æ–°çš„é©±åŠ¨å³å¯ã€‚</p>
<p>å‚è€ƒæ–‡ç« ï¼šhttps://www.zhihu.com/people/sun-yan-90-29</p>
]]></content>
    </entry>
</feed>